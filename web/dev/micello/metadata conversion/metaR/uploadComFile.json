{"fileType":"apogee workspace","jsLinks":["http://localhost:8383/apogee/dev/micello/metadata%20conversion/lib/taskAppModule.js"],"cssLinks":[],"workspace":{"fileType":"apogee workspace","version":0.2,"data":{"name":"uploadComFile","type":"apogee.Folder","children":{"tasks":{"name":"tasks","type":"apogee.Folder","children":{"login":{"name":"login","type":"apogee.Folder","children":{"loginUrl":{"name":"loginUrl","type":"apogee.JsonTable","updateData":{"data":"http://eng.micello.com/TestAuthorization/loginjson","description":""}},"loginControl":{"name":"loginControl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"return loginUrl;","supplementalCode":"","description":""}},"sessionResponse":{"name":"sessionResponse","type":"apogee.JsonTable","updateData":{"data":{"responseCode":1,"paramTable":[{"urlPattern":"http://eng.micello.com/mfs","params":[["key","S1sshnIV1Rk9EGz32Acrl8aSYsTKYd"]]},{"urlPattern":"http://mfs.micello.com","params":[["key","nS71TmmSmgvwcXlfrGrin38AMLP48B"]]},{"urlPattern":"http://factory-mfs.micello.com","params":[["key","yfZkszbELEy6lxz1sSeUZscJlC41hL"]]},{"urlPattern":"http://mfs-hub-master.micello.com/","params":[["key","pvLuRozg2EZVrpE8nCpCrQT0FOHcLh"]]},{"urlPattern":"http://mfs-us-1.micello.com","params":[["key","nS71TmmSmgvwcXlfrGrin38AMLP48B"]]},{"urlPattern":"http://eng.micello.com/mfs-node","params":[["key","dnSkxyrgxRNtGMUYbhgV8uvdPW1V4U"]]}],"sessionKey":"SESS0f6c4c2238a670b8138b63d9fd03cc22=asqbocm181fd6460kktht44ib6"},"description":""}},"state":{"name":"state","type":"apogee.JsonTable","updateData":{"data":{"active":false,"previousTask":[]},"description":""}},"result":{"name":"result","type":"apogee.JsonTable","updateData":{"data":{"valid":false,"data":null},"description":""}},"taskResult":{"name":"taskResult","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var output = {};\nvar sessionKey;\nif(sessionResponse) {\n    if(sessionResponse.responseCode === 1) {\n        data = {};\n        data.sessionKey = sessionResponse.sessionKey;\n        data.paramTable = sessionResponse.paramTable;\n        output.data = data;\n        taskAppModule.taskCompleted(apogeeMessenger,[\"login\"],[\"loadCid\"],data);\n        return \"SUCCESS\";\n    }\n    else {\n        alert(\"There was an error: \" + JSON.stringify(sessionResponse));\n        return \"ERROR\";\n    }\n}\nelse {\n    return \"INCOMPLETE\";\n}","supplementalCode":"","description":""}}}},"upload":{"name":"upload","type":"apogee.Folder","children":{"uploadFile":{"name":"uploadFile","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if((loadCid.result.valid)&&(selectCidPostProcess.outputFile)) {\n    return selectCidPostProcess.outputFile;\n}\nelse {\n    return null;\n}","supplementalCode":"","description":""}},"submitControl":{"name":"submitControl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var data = {};\ndata.uploadFile = uploadFile;\ndata.previousTask = state.previousTask;\n\nreturn data;","supplementalCode":"","description":""}},"result":{"name":"result","type":"apogee.JsonTable","updateData":{"data":{"valid":false,"data":null},"description":""}},"state":{"name":"state","type":"apogee.JsonTable","updateData":{"data":{"active":false,"previousTask":null},"description":""}},"taskResult":{"name":"taskResult","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var resultValue;\n\nvar taskResult = {};\nif(!liveUploadFile) {\n    return \"WAITING\";\n}\nelse if(uploadResponse.length > 0) {\n    data = {};\n    data.uploadResponse = uploadResponse;\n    taskAppModule.taskCompleted(apogeeMessenger,[\"upload\"],[\"completed\"],data);\n    resultValue = \"SUCCESS\";\n}\nelse {\n    alert(\"Error making commit: \" + uploadResponse.msg);\n    resultValue = \"ERROR\";\n}\n\n//for error or success - clear the commit request\nvar updateInfo = [];\nupdateInfo.push([\"liveUploadFile\",null]);\napogeeMessenger.compoundDataUpdate(updateInfo);\n    \nreturn resultValue;","supplementalCode":"","description":""}},"liveUploadFile":{"name":"liveUploadFile","type":"apogee.JsonTable","updateData":{"data":null,"description":""}},"url":{"name":"url","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if((loadCid.result.valid)&&(selectCidPostProcess.outputUrl)) {\n    return selectCidPostProcess.outputUrl;\n}\nelse {\n    return null;\n}","supplementalCode":"","description":""}},"uploadResponse":{"name":"uploadResponse","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!liveUploadFile) return null;\n\nvar options = {};\noptions.method = \"POST\";\noptions.body = liveUploadFile;\n\nreturn apogee.net.jsonRequest(url,options);","supplementalCode":"","description":""}}}},"currentTask":{"name":"currentTask","type":"apogee.JsonTable","updateData":{"data":["login"],"description":""}},"commonData":{"name":"commonData","type":"apogee.Folder","children":{"fileTypeList":{"name":"fileTypeList","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var sessionKey = getSessionKey();\nif(!sessionKey) return null;\n\nvar fileTypeSearch = {};\nfileTypeSearch.search = \"file_type_list\";\n\nreturn micemetarDataAccess.getRequestPromise(fileTypeSearch,sessionKey);\n\n","supplementalCode":"","description":""}},"fileTypeLookupTable":{"name":"fileTypeLookupTable","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!fileTypeList) return null;\n\nvar lookupTable = {};\n\nvar isFileType = (record) => record.Type == \"file_type\";\nvar addToLookupTable = (record) => lookupTable[record.Id] = record.Fields.file_type_name;\n\nfileTypeList.data.Response.filter(isFileType).forEach(addToLookupTable);\n\nreturn lookupTable;","supplementalCode":"","description":""}},"getFileTypeName":{"name":"getFileTypeName","type":"apogee.FunctionTable","updateData":{"argList":["fileTypeId"],"functionBody":"return fileTypeLookupTable[fileTypeId];","supplementalCode":"","description":""}},"getSessionKey":{"name":"getSessionKey","type":"apogee.FunctionTable","updateData":{"argList":[],"functionBody":"if(login.result.valid) {\n    return login.result.data.sessionKey;\n}\nelse {\n    return null;\n}","supplementalCode":"","description":""}},"getParamTable":{"name":"getParamTable","type":"apogee.FunctionTable","updateData":{"argList":[],"functionBody":"if(login.result.valid) {\n    return login.result.data.paramTable;\n}\nelse {\n    return null;\n}","supplementalCode":"","description":""}},"fileInfo":{"name":"fileInfo","type":"apogee.Folder","children":{"mfsBaseUrl":{"name":"mfsBaseUrl","type":"apogee.JsonTable","updateData":{"data":"http://eng.micello.com/mfs/ms/v1/mfile","description":""}},"getUploadType":{"name":"getUploadType","type":"apogee.FunctionTable","updateData":{"argList":["context"],"functionBody":"if(context == \"public\") return \"global\";\nelse if(context.startsWith(\"com_\")) return \"community\";\nelse if(context.startsWith(\"~\")) return \"customer\";\nelse throw new Error(\"Upload type not known for context \" + context);","supplementalCode":"","description":""}},"getCommunityIdentifier":{"name":"getCommunityIdentifier","type":"apogee.FunctionTable","updateData":{"argList":["context"],"functionBody":"var prefixLength = COMMUNITY_PREFIX.length;\r\nreturn context.substr(prefixLength);","supplementalCode":"","description":""}},"COMMUNITY_PREFIX":{"name":"COMMUNITY_PREFIX","type":"apogee.JsonTable","updateData":{"data":"com_","description":""}},"getCustomerIdentifier":{"name":"getCustomerIdentifier","type":"apogee.FunctionTable","updateData":{"argList":["context"],"functionBody":"var name = customerAuthToPathName[context];\n\nif(name === undefined) throw new Error(\"Customer name not found for: \" + context);\n\nreturn name;","supplementalCode":"","description":""}},"customerAuthToPathName":{"name":"customerAuthToPathName","type":"apogee.JsonTable","updateData":{"data":{"~anthem":"anthem"},"description":""}},"urlFormatLookupTable":{"name":"urlFormatLookupTable","type":"apogee.JsonTable","updateData":{"data":{"NOTES":["{0} is for the file name, {1} is for the identifier, either cid or customer name"],"community":{"propertyRules":"/map/{1}/overrides/presets","themeRules":"/map/{1}/overrides/thememap","theme":"/map/{1}/overrides/theme/{0}","strings":"/map/{1}/overrides/strings","inputColors":"/map/{1}/overrides/inputcolors"},"customer":{"propertyRules":"/customer/{1}/overrides/{0}/presets","themeRules":"/customer/{1}/overrides/{0}/thememap","theme":"/customer/{1}/overrides/{0}/theme","strings":"/customer/{1}/overrides/{0}/strings","inputColors":"/customer/{1}/overrides/{0}/inputcolors"},"global":{"propertyRules":"/meta/presets/v5/{0}","themeRules":"/meta/thememap/v5/{0}","theme":"/meta/theme/v5/{0}","strings":"/meta/strings/v5/{0}","inputColors":"/meta/miceditor/inputcolors/v5/{0}"}},"description":""}},"overrideSectionLookupTable":{"name":"overrideSectionLookupTable","type":"apogee.JsonTable","updateData":{"data":{"propertyRules":"presetOverrides","themeRules":"themeMapOverrides","theme":"themeOverrides","strings":"stringsOverrides","inputColors":"inputColorOverrides"},"description":""}},"getUrlParams":{"name":"getUrlParams","type":"apogee.FunctionTable","updateData":{"argList":["url"],"functionBody":"var paramTable = getParamTable();\nif(!paramTable) {\n    throw new Error(\"Param table needed for MFS upload\");\n}\n\nvar isMatchingKey = (paramEntry) => url.startsWith(paramEntry.urlPattern);\n\nvar paramEntry = paramTable.find(isMatchingKey);\nvar paramString;\n\nif((paramEntry)&&(paramEntry.params.length > 0)) {\n    var appendParam = (inParamString,paramData) => {\n        var seperator;\n        if(inParamString == \"\") {\n            seperator = \"?\";\n        }\n        else {\n            seperator = \"&\";\n        }\n        return inParamString + seperator + paramData[0] + \"=\" + paramData[1];\n    }\n    \n    paramString = paramEntry.params.reduce(appendParam,\"\");\n}\nelse {\n    paramString = \"\";\n}\n\nreturn paramString;\n\n","supplementalCode":"","description":""}},"comFileUrlFormatString":{"name":"comFileUrlFormatString","type":"apogee.JsonTable","updateData":{"data":"/map/{0}/overrides","description":"The input parameter is CID"}},"getMetaFileUrl":{"name":"getMetaFileUrl","type":"apogee.FunctionTable","updateData":{"argList":["uploadType","fileType","fileOptionName","identifier"],"functionBody":"var urlFormatString = urlFormatLookupTable[uploadType][fileType]; \n\nreturn mfsBaseUrl + apogee.util.formatString(urlFormatString,fileOptionName,identifier);","supplementalCode":"","description":""}},"getComFileUrl":{"name":"getComFileUrl","type":"apogee.FunctionTable","updateData":{"argList":["cid"],"functionBody":"var url = mfsBaseUrl + apogee.util.formatString(comFileUrlFormatString,cid);\n\nvar queryParams = getUrlParams(url);\n\nreturn url + queryParams;","supplementalCode":"","description":""}},"getMetaFileInfo":{"name":"getMetaFileInfo","type":"apogee.FunctionTable","updateData":{"argList":["fileType","context","name"],"functionBody":"var uploadType = getUploadType(context);\nvar identifier;\n\nswitch(uploadType) {\n    case \"community\":\n        identifier = getCommunityIdentifier(context);\n        break;\n        \n    case \"customer\":\n        identifier = getCustomerIdentifier(context);\n        break;\n        \n    case \"global\":\n        identifier = null;\n        break;\n}\n\nvar fileInfo = {};\nfileInfo.url = getMetaFileUrl(uploadType,fileType,name,identifier);\nfileInfo.overrideSection = overrideSectionLookupTable[fileType];\n\nif(fileType == \"theme\") {\n    fileInfo.subsection = name;\n}\n\nreturn fileInfo;\n","supplementalCode":"","description":""}}}}}},"completed":{"name":"completed","type":"apogee.Folder","children":{"resetControl":{"name":"resetControl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"","supplementalCode":"","description":""}},"result":{"name":"result","type":"apogee.JsonTable","updateData":{"data":{"valid":false,"data":null},"description":""}},"state":{"name":"state","type":"apogee.JsonTable","updateData":{"data":{"active":false,"previousTask":null},"description":""}}}},"loadCid":{"name":"loadCid","type":"apogee.Folder","children":{"state":{"name":"state","type":"apogee.JsonTable","updateData":{"data":{"active":false,"previousTask":null},"description":""}},"result":{"name":"result","type":"apogee.JsonTable","updateData":{"data":{"valid":false,"data":null},"description":""}},"cidControl":{"name":"cidControl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"return null;","supplementalCode":"","description":""}}}},"selectCidPostProcess":{"name":"selectCidPostProcess","type":"apogee.Folder","children":{"sessionKey":{"name":"sessionKey","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"return commonData.getSessionKey();","supplementalCode":"","description":""}},"cid":{"name":"cid","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(loadCid.result.valid) {\n    return loadCid.result.data.cid;\n}\nelse {\n    return null;\n}","supplementalCode":"","description":""}},"comFileResponse":{"name":"comFileResponse","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!sessionKey) return null;\nif(!cid) return null;\n\nvar context = commonData.fileInfo.COMMUNITY_PREFIX + cid;\n\nvar searchDef = {};\nsearchDef.search = \"community_files_extended\";\nsearchDef.file_context = context;\n\nreturn micemetarDataAccess.getRequestPromise(searchDef,sessionKey);\n\n\n\n\n\n\n","supplementalCode":"","description":""}},"comFileRecord":{"name":"comFileRecord","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!comFileResponse) {\n    return null;\n}\n\nif(!comFileResponse.success) {\n    throw new Error(\"Com File request error\");\n}\n\nif(comFileResponse.data.Response.length === 0) {\n    throw new Error(\"Com file not found\");\n}\n\nif(comFileResponse.data.Response.length > 1) {\n    throw new Error(\"Too many com files!\");\n}\n\nreturn comFileResponse.data.Response[0];","supplementalCode":"","description":""}},"metaFileRecordMap":{"name":"metaFileRecordMap","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!comFileResponse) return null;\n\nvar output = {};\n\nvar isMetaFile = entry => entry.Type == \"meta_file\";\nvar addToMap = record => output[record.Id] = record;\n\ncomFileResponse.data.Records.filter(isMetaFile).forEach(addToMap);\n\nreturn output;","supplementalCode":"","description":""}},"getMetaFileRecord":{"name":"getMetaFileRecord","type":"apogee.FunctionTable","updateData":{"argList":["recordId"],"functionBody":"return metaFileRecordMap[recordId];\n","supplementalCode":"","description":""}},"metaFileInfo":{"name":"metaFileInfo","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!comFileResponse) return null;\n\nvar getMetaFile = comFileEntry => getMetaFileRecord(comFileEntry.Fields.meta_file_id);\n\nvar getMetaFileInfoInput =  metaFile => {\n    var info = {};\n    info.fileType = commonData.getFileTypeName(metaFile.Fields.file_type_id);\n    info.context = metaFile.Fields.file_context;\n    info.name = metaFile.Fields.name;\n    return info;\n}\n\nvar metaFileInfoInputList = comFileOverrideEntries.map(getMetaFile).map(getMetaFileInfoInput);\n\nvar getMetaFileInfo = metaFileInfoInput => commonData.fileInfo.getMetaFileInfo(metaFileInfoInput.fileType,metaFileInfoInput.context,metaFileInfoInput.name);\n\nvar metaFileInfoList = metaFileInfoInputList.map(getMetaFileInfo);\n\nreturn metaFileInfoList;","supplementalCode":"","description":""}},"outputFile":{"name":"outputFile","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!comFileResponse) return null;\n\nvar output = {};\n\n//add the cid\noutput.cid = cid;\n\n//populate the urls\nvar addToOutput = (metaFileInfoEntry) => {\n    var section = output[metaFileInfoEntry.overrideSection];\n    \n    if(metaFileInfoEntry.subsection) {\n        if(!section) {\n            section = {};\n            output[metaFileInfoEntry.overrideSection] = section;\n        }\n        \n        var subsection = section[metaFileInfoEntry.subsection];\n        if(!subsection) {\n            subsection = [];\n            section[metaFileInfoEntry.subsection] = subsection;\n        }\n        \n        subsection.push(metaFileInfoEntry.url);\n    }\n    else {\n        if(!section) {\n            section = [];\n            output[metaFileInfoEntry.overrideSection] = section;\n        }\n        \n        section.push(metaFileInfoEntry.url);\n    }\n}\n\nif(metaFileInfo.length > 0) {\n    metaFileInfo.forEach(addToOutput);\n}\nelse {\n    output.none = true;\n}\n\nreturn output;","supplementalCode":"","description":""}},"comFileOverrideEntries":{"name":"comFileOverrideEntries","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(!comFileResponse) return null;\n\nvar isComFileEntry = entry => entry.Type == \"com_file_entry\";\nvar isOverride = entry => entry.Fields.file_group == \"override\";\n\nreturn comFileResponse.data.Records.filter(isComFileEntry).filter(isOverride);","supplementalCode":"","description":""}},"outputUrl":{"name":"outputUrl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"return commonData.fileInfo.getComFileUrl(cid);","supplementalCode":"","description":""}}}}}},"micemetarDataAccess":{"name":"micemetarDataAccess","type":"apogee.Folder","children":{"createRecord":{"name":"createRecord","type":"apogee.FunctionTable","updateData":{"argList":["recordType","fieldMap"],"functionBody":"var record = {};\n\nrecord.Id = getId();\nrecord.Type = recordType;\nrecord.Fields = fieldMap;\nrecord.read_perm = READ_PERM;\nrecord.edit_perm = EDIT_PERM;\n\nreturn record;","supplementalCode":"var READ_PERM = 2;\nvar EDIT_PERM = 15;\n\n//this will be illegal at some point\nvar nextId = -1;\n\nfunction getId() {\n    return nextId--;\n}","description":"This method creates a record given the field values and record info \nfrom the data set info. It creates and ID and uses standard permissions."}},"recordsToCreateInstructions":{"name":"recordsToCreateInstructions","type":"apogee.FunctionTable","updateData":{"argList":["recordList"],"functionBody":"var instructions = [];\n\nfor(var i = 0; i < recordList.length; i++) {\n    var createRecord = recordList[i];\n    var instruction = createCreateInstruction(createRecord);\n    instructions.push(instruction);\n}\n\nreturn instructions;","supplementalCode":"","description":"This creates a list of create instructions to go along with a list of records to be created.\n\nThere is the option to assign the ID or to leave it as undefined, in which case\nan automatically incremented ID will be assigned. (For consistency in the data\nset, either all records should be preassigned or all records should be \nautomatically assigned."}},"createCommitBody":{"name":"createCommitBody","type":"apogee.FunctionTable","updateData":{"argList":["instructionList","commitMessage"],"functionBody":"var commit = {};\nvar actions = [];\n\nif(commitMessage.length === 0) throw new Error(\"Commit message missing!\");\n\ncommit.Name = dataSetInfo.name;\ncommit.Message = commitMessage;\ncommit.Actions = actions;\n\n//single action with commits\nvar action = {};\naction.Title = \"bulk create commit\";\naction.Instr = instructionList;\nactions.push(action);\n\nreturn commit","supplementalCode":"","description":"This creates a body for a commit request, given a list of instructions and a commit message."}},"createRequestOptions":{"name":"createRequestOptions","type":"apogee.FunctionTable","updateData":{"argList":["bodyJson","sessionKey"],"functionBody":"var header = {};\nheader[\"Content-Type\"] = \"text/plain;charset=UTF-8\";\nheader.sessionKey = sessionKey;\nheader[\"proto-version\"] = \"4.0\";\nheader[\"db-version\"] = dataSetInfo.version;\n\nrequestInfo = {};\nrequestInfo.header = header;\nif(bodyJson) {\n    requestInfo.method = \"POST\";\n    requestInfo.body = JSON.stringify(bodyJson);\n}\n\nreturn requestInfo;\n","supplementalCode":"","description":"This creates the requestOptions, suitable for apogee.net.jsonRequest, to go with an type of request to the workingset (micemetarequest) server."}},"host":{"name":"host","type":"apogee.JsonTable","updateData":{"data":"http://localhost:8080/micemetarws","description":""}},"commitUrl":{"name":"commitUrl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = host + \"/commit\";\nreturn value;\n\n","supplementalCode":"","description":""}},"requestUrl":{"name":"requestUrl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"return host + \"/cannedsearch\";\n\n","supplementalCode":"","description":""}},"dataSetInfo":{"name":"dataSetInfo","type":"apogee.JsonTable","updateData":{"data":{"records":{"com_file_entry":{"idField":"com_file_entry_id","name":"com_file_entry","foreignList":[],"fields":[{"defaultValue":0,"name":"ordr","nullOk":false,"fieldClass":"java.lang.Integer"},{"defaultValue":null,"name":"com_file_id","nullOk":false,"fieldClass":"com.micello.micemetar.data.ComFile"},{"defaultValue":null,"name":"meta_file_id","nullOk":false,"fieldClass":"com.micello.micemetar.data.MetaFile"},{"defaultValue":null,"name":"file_group","nullOk":false,"fieldClass":"java.lang.String"}],"recordClass":"com.micello.micemetar.data.ComFileEntry"},"file_type":{"idField":"file_type_id","name":"file_type","foreignList":[{"remoteRecord":"file_entry","name":"file_entry_list","isUnique":false,"remoteField":"file_type_id","restrictDelete":true}],"fields":[{"defaultValue":null,"name":"file_type_name","nullOk":true,"fieldClass":"java.lang.String"}],"recordClass":"com.micello.micemetar.data.FileType"},"file_entry":{"idField":"file_entry_id","name":"file_entry","foreignList":[],"fields":[{"defaultValue":null,"name":"entry_context","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"entry_name","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"file_type_id","nullOk":false,"fieldClass":"com.micello.micemetar.data.FileType"},{"defaultValue":null,"name":"entry_section","nullOk":true,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"entry_key","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"option_name","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"entry_data","nullOk":false,"fieldClass":"org.json.JSONObject"}],"recordClass":"com.micello.micemetar.data.FileEntry"},"recipe_entry":{"idField":"recipe_entry_id","name":"recipe_entry","foreignList":[],"fields":[{"defaultValue":0,"name":"ordr","nullOk":false,"fieldClass":"java.lang.Integer"},{"defaultValue":null,"name":"meta_file_id","nullOk":false,"fieldClass":"com.micello.micemetar.data.MetaFile"},{"defaultValue":null,"name":"file_entry_id","nullOk":false,"fieldClass":"com.micello.micemetar.data.FileEntry"},{"defaultValue":null,"name":"insertion_info","nullOk":true,"fieldClass":"org.json.JSONObject"}],"recordClass":"com.micello.micemetar.data.RecipeEntry"},"com_file":{"idField":"com_file_id","name":"com_file","foreignList":[{"remoteRecord":"com_file_entry","name":"com_file_entry_list","isUnique":false,"remoteField":"com_file_id","restrictDelete":true,"orderField":"ordr"}],"fields":[{"defaultValue":null,"name":"file_context","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"name","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"ref","nullOk":true,"fieldClass":"java.lang.String"}],"recordClass":"com.micello.micemetar.data.ComFile"},"meta_file":{"idField":"meta_file_id","name":"meta_file","foreignList":[{"remoteRecord":"recipe_entry","name":"recipe_entry_list","isUnique":false,"remoteField":"meta_file_id","restrictDelete":true,"orderField":"ordr"}],"fields":[{"defaultValue":null,"name":"file_type_id","nullOk":false,"fieldClass":"com.micello.micemetar.data.FileType"},{"defaultValue":null,"name":"file_context","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"name","nullOk":false,"fieldClass":"java.lang.String"},{"defaultValue":null,"name":"ref","nullOk":true,"fieldClass":"org.json.JSONObject"}],"recordClass":"com.micello.micemetar.data.MetaFile"}},"name":"Micemetar","version":"5.0"},"description":""}},"createUpdateInstruction":{"name":"createUpdateInstruction","type":"apogee.FunctionTable","updateData":{"argList":["initialRecord","targetRecord"],"functionBody":"if(initialRecord.Id != targetRecord.Id) {\n    throw new Error(\"Record ID mismatch in create update instruction for target record: \" + getRecordErrString(targetRecord));\n}\n\nif(initialRecord.Type != targetRecord.Type) {\n    throw new Error(\"Inital and target record types do not match. Target record: \" + getRecordErrString(targetRecord));\n}\n\nvar recordsDifferent = false;\n\nvar recordInfo = getRecordInfo(initialRecord.Type);\n\nvar instruction = {};\ninstruction.Type = \"Update\";\ninstruction.Record = recordInfo.name;\ninstruction.Id = initialRecord.Id;\n\ninstruction.initialReadPerm = initialRecord.read_perm;\ninstruction.initialEditPerm = initialRecord.edit_perm;\n\nif(initialRecord.readPerm != targetRecord.readPerm) {\n    instruction.targetReadPerm = targetRecord.read_perm;\n    recordsDifferent = true;\n}\n\nif(initialRecord.editPerm != targetRecord.editPerm) {\n    instruction.targetEditPerm = targetRecord.edit_perm;\n    recordsDifferent = true;\n}\n\nvar initialData = {};\ninstruction.Initial = initialData;\nvar targetData = {};\ninstruction.Target = targetData;\n\nfor(var i = 0; i < recordInfo.fields.length; i++) {\n    var field = recordInfo.fields[i];\n    \n    var initialValue;\n    var targetValue;\n    \n    var initialValue = initialRecord.Fields[field.name];\n    var targetValue = targetRecord.Fields[field.name];\n    \n    //validate target values\n    if(targetValue === undefined) {\n        //use default\n        targetValue = field.defaultValue;\n    }\n    \n    if(targetValue === undefined) {\n        throw new Error(\"Unknown problem: undefined field value: \" + getFieldErrString(targetRecord,field));\n    }\n    \n    if(targetValue === null) {\n        if(!field.nullOk) {\n            throw new Error(\"Illegal null value: \" + getFieldErrString(targetRecord,field));\n        }\n    }\n    \n    if(!fieldsMatch(initialValue,targetValue,field)) {\n        initialData[field.name] = initialValue;\n        targetData[field.name] = targetValue;\n        recordsDifferent = true;\n    }\n}\n\nif(recordsDifferent) {\n    return instruction;\n}\nelse {\n    return null;\n}\n","supplementalCode":"function fieldsMatch(initialValue,targetValue,fieldInfo) {\n    if(fieldInfo.fieldClass === \"java.lang.String\") {\n        //compare strings with \"==\"\n        return (initialValue == targetValue);\n    }\n    else if(fieldInfo.fieldClass.startsWith(\"java.lang\")) {\n        //compare other basic values with \"===\"\n        return initialValue === targetValue;\n    }\n    else if(fieldInfo.fieldClass.startsWith(\"com.micello\")) {\n        return initialValue === targetValue;\n    }\n    else if(fieldInfo.fieldClass == \"org.json.JSONObject\") {\n        return compareJsonData(initialValue,targetValue);\n    }\n    else if(fieldInfo.fieldClass == \"org.json.JSONArray\") {\n        return compareJsonData(initialValue,targetValue);\n    }\n    else {\n        throw new Error(\"unrecognized field type: \" + fieldInfo.fieldClass);\n    }\n}\n\nfunction compareJsonData(a,b) {\n    var an = apogee.util.getNormalizedObjectCopy(a);\n    var bn = apogee.util.getNormalizedObjectCopy(b);\n    var aString = JSON.stringify(an);\n    var bString = JSON.stringify(bn);\n    return aString == bString;\n}\n    ","description":"This function creates an update instruction given an initial and target record. If the records are the same then NULL is returned. (No update is needed.)"}},"createCreateInstruction":{"name":"createCreateInstruction","type":"apogee.FunctionTable","updateData":{"argList":["createRecord"],"functionBody":"\nvar recordInfo = getRecordInfo(createRecord.Type);\n\nvar instruction = {};\ninstruction.Type = \"Create\";\ninstruction.Record = recordInfo.name;\ninstruction.Id = createRecord.Id;\n\ninstruction.targetReadPerm = createRecord.read_perm;\ninstruction.targetEditPerm = createRecord.edit_perm;\n\nvar targetData = {};\ninstruction.Target = targetData;\n\nfor(var i = 0; i < recordInfo.fields.length; i++) {\n    var field = recordInfo.fields[i];\n    var targetValue;\n    var targetValue = createRecord.Fields[field.name];\n    if(targetValue === undefined) {\n        //use default\n        targetValue = field.defaultValue;\n    }\n    \n    if(targetValue === undefined) {\n        throw new Error(\"Unknown problem: undefined field value: \" + getFieldErrString(createRecord,field));\n    }\n    \n    if(targetValue === null) {\n        if(!field.nullOk) {\n            throw new Error(\"Illegal null value: \" + getFieldErrString(createRecord,field));\n        }\n    }\n    \n    targetData[field.name] = targetValue;\n}\n\nreturn instruction;\n","supplementalCode":"","description":""}},"getFieldErrString":{"name":"getFieldErrString","type":"apogee.FunctionTable","updateData":{"argList":["record","fieldInfo"],"functionBody":"return getRecordErrString(record) + \" - \" + fieldInfo.name;","supplementalCode":"","description":""}},"getRecordErrString":{"name":"getRecordErrString","type":"apogee.FunctionTable","updateData":{"argList":["record"],"functionBody":"return record.Type + \" \" + record.Id;","supplementalCode":"","description":""}},"createDeleteInstruction":{"name":"createDeleteInstruction","type":"apogee.FunctionTable","updateData":{"argList":["deleteRecord"],"functionBody":"\nvar recordInfo = getRecordInfo(deleteRecord.Type);\n\nvar instruction = {};\ninstruction.Type = \"Delete\";\ninstruction.Record = recordInfo.name;\ninstruction.Id = deleteRecord.Id;\n\ninstruction.initialReadPerm = deleteRecord.read_perm;\ninstruction.initialEditPerm = deleteRecord.edit_perm;\n\nvar initialData = {};\ninstruction.Initial = initialData;\n\nfor(var i = 0; i < recordInfo.fields.length; i++) {\n    var field = recordInfo.fields[i];\n    var initialValue = deleteRecord.Fields[field.name];\n    \n    initialData[field.name] = initialValue;\n}\n\nreturn instruction;\n","supplementalCode":"","description":""}},"getRecordInfo":{"name":"getRecordInfo","type":"apogee.FunctionTable","updateData":{"argList":["recordType"],"functionBody":"var recordInfo = dataSetInfo.records[recordType];\n\nif(!recordInfo) {\n    throw new Error(\"Record type not found in getRecordInfo: \" + recordType);\n}\n\nreturn recordInfo;","supplementalCode":"","description":""}},"combinedEntriesToInstructionList":{"name":"combinedEntriesToInstructionList","type":"apogee.FunctionTable","updateData":{"argList":["combinedEntries"],"functionBody":"var output = [];\nfor(var key in combinedEntries) {\n    var entry = combinedEntries[key];\n    var instruction = getInstructionForCombinedEntry(entry);\n    if(instruction) {\n        output.push(instruction);\n    }\n}\n\nreturn output;","supplementalCode":"function getInstructionForCombinedEntry(combinedEntry) {\n    var newEntry = combinedEntry.newEntry;\n    var oldEntry = combinedEntry.oldEntry;\n    \n    if(newEntry) {\n        if(!oldEntry) {\n            console.log(\"Create: \" + newEntry.Id);\n            return createCreateInstruction(newEntry);\n        }\n        else {\n            //this will return null for matching records\n            console.log(\"Update(maybe): \" + newEntry.Id);\n            return createUpdateInstruction(oldEntry,newEntry);\n        }\n    }\n    else if(oldEntry) {\n        console.log(\"Delete: \" + oldEntry.Id);\n        return createDeleteInstruction(oldEntry);\n    }\n    \n    return null;\n}\n\nfunction entriesDifferent(entry1,entry2) {\n    var string1 = JSON.stringify(apogee.util.getNormalizedCopy(entry1));\n    var string2 = JSON.stringify(apogee.util.getNormalizedCopy(entry2));\n    return (string1 == string2);\n}","description":"This function takes a combined entry map of the format:\n\n{\n  \"some-identifier\":{\n    \"oldEntry\":{original record entry, if applicable},\n    \"newEntry\":{new record entry, if applicable}\n  },\n  ...\n}\n\nIt returns an instruction list.\n\n"}},"getCommitPromise":{"name":"getCommitPromise","type":"apogee.FunctionTable","updateData":{"argList":["instructionList","commitMessage","sessionKey"],"functionBody":"var commitBody = createCommitBody(instructionList,commitMessage);\nvar requestOptions = createRequestOptions(commitBody,sessionKey);\nreturn apogee.net.jsonRequest(commitUrl,requestOptions);","supplementalCode":"","description":""}},"getRequestPromise":{"name":"getRequestPromise","type":"apogee.FunctionTable","updateData":{"argList":["requestBody","sessionKey"],"functionBody":"var requestOptions = createRequestOptions(requestBody,sessionKey);\nreturn apogee.net.jsonRequest(requestUrl,requestOptions);","supplementalCode":"","description":""}},"customRequestUrl":{"name":"customRequestUrl","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"return host + \"/request\";","supplementalCode":"","description":""}},"getCustomRequestPromise":{"name":"getCustomRequestPromise","type":"apogee.FunctionTable","updateData":{"argList":["requestBody","sessionKey"],"functionBody":"var requestOptions = createRequestOptions(requestBody,sessionKey);\nreturn apogee.net.jsonRequest(customRequestUrl,requestOptions);","supplementalCode":"","description":""}}}}}}},"components":{"tasks":{"type":"apogeeapp.app.FolderComponent","children":{"login":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":79,"y":21}},"children":{"loginUrl":{"type":"apogeeapp.app.TextComponent","windowState":{"sizeInfo":{"width":460,"height":32},"posInfo":{"x":26,"y":27},"state":0,"viewType":"Text"}},"loginControl":{"type":"apogeeapp.app.CustomControlComponent","windowState":{"sizeInfo":{"width":405,"height":71},"posInfo":{"x":27,"y":111},"state":0,"viewType":"Output"},"resource":{"html":"","css":"","setData":"this.loginUrl = data;","constructorAddition":"\n\n//this uses the updated version of test authorization that takes and returns a JSON\nthis.onClick = function() {\n    \n    //on click\n    var bodyJson = {};\n    bodyJson.userName = resource.userInput.value;\n    bodyJson.password = resource.passwordInput.value;\n    \n    //cleaer password field\n    resource.passwordInput.value = \"\";\n    \n    var options = {};\n    options.body = JSON.stringify(bodyJson);\n    options.method = \"POST\";\n    \n    var requestPromise = apogee.net.jsonRequest(this.loginUrl,options);\n    \n    //set the response\n    mode.getMessenger().asynchDataUpdate(\"sessionResponse\",requestPromise);\n}","init":"\nvar label1 = document.createElement(\"label\");\nlabel1.for = \"userInput\";\nlabel1.innerHTML = \"User:\"\nelement.appendChild(label1);\n\nvar input1 = document.createElement(\"input\");\ninput1.id = \"userInput\";\nresource.userInput = input1;\nelement.appendChild(input1);\n\nelement.appendChild(document.createElement(\"br\"));\n\nvar label2 = document.createElement(\"label\");\nlabel2.for = \"passwordInput\";\nlabel2.innerHTML = \"Password:\"\nelement.appendChild(label2);\n\nvar input2 = document.createElement(\"input\");\ninput2.id = \"passwordInput\";\ninput2.type = \"password\";\nresource.passwordInput = input2;\nelement.appendChild(input2);\n\nelement.appendChild(document.createElement(\"br\"));\n\nvar button = document.createElement(\"button\");\nbutton.innerHTML = \"Login\";\nelement.appendChild(button);\n\nvar instance = this;\nbutton.onclick = function() {\n    instance.onClick();\n}\n\n\n"}},"sessionResponse":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":626,"height":366},"posInfo":{"x":30,"y":283},"state":-1,"viewType":"Text"}},"state":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":292,"height":71},"posInfo":{"x":575,"y":43},"state":-1,"viewType":"Text"}},"result":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":273,"height":77},"posInfo":{"x":576,"y":93},"state":-1,"viewType":"Text"}},"taskResult":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":649,"height":266},"posInfo":{"x":26,"y":337},"state":-1,"viewType":"Formula"}}}},"upload":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":25,"y":25}},"children":{"uploadFile":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":594,"height":324},"posInfo":{"x":41,"y":45},"state":-1,"viewType":"Formula"}},"submitControl":{"type":"apogeeapp.app.CustomControlComponent","windowState":{"sizeInfo":{"width":364,"height":69},"posInfo":{"x":36,"y":114},"state":0,"viewType":"Output"},"resource":{"html":"Press upload to upload the file to the given MFS url.<br>\n<input type=\"button\" id=\"submit_commitButton\" value=\"Upload\"></input>\n<input type=\"button\" id=\"submit_cancelButton\" value=\"Cancel\"></input>","onLoad":"this.submitButton = document.getElementById(\"submit_commitButton\");\nthis.cancelButton = document.getElementById(\"submit_cancelButton\");\nthis.initialized = true;\n\nvar instance = this;\nthis.submitButton.onclick = function() {\n    instance.onSubmit();\n}\nthis.cancelButton.onclick = function() {\n    instance.onCancel();\n}","constructorAddition":"this.submitButton = null;\nthis.cancelButton = null;\nthis.initialized = false;\n\nthis.onSubmit = function() {\n    \n    if(!this.initialized) {\n        return;\n    }\n    \n    if((!this.uploadFile)||(this.uploadFile.length === 0)) {\n        alert(\"There is no data to commit.\");\n        return;\n    }\n    \n    var updateInfo = [];\n    updateInfo.push([\"liveUploadFile\",this.uploadFile]);\n    mode.getMessenger().compoundDataUpdate(updateInfo,true);\n}\n\nthis.onCancel = function() {\n    console.log(this.previousTask);\n    taskAppModule.taskCanceled(mode.getMessenger(),[\"submit\"],this.previousTask);\n}","setData":"if(!data) return;\n\nthis.uploadFile = data.uploadFile;\nthis.previousTask = data.previousTask;","css":""}},"result":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":303,"height":81},"posInfo":{"x":805,"y":273},"state":0,"viewType":"Text"}},"state":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":290,"height":106},"posInfo":{"x":802,"y":116},"state":0,"viewType":"Text"}},"taskResult":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":654,"height":437},"posInfo":{"x":527,"y":259},"state":-1,"viewType":"Formula"}},"liveUploadFile":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":522,"y":132},"state":-1,"viewType":"Text"}},"url":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":778,"height":324},"posInfo":{"x":251,"y":46},"state":-1,"viewType":"JSON"}},"uploadResponse":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":843,"height":315},"posInfo":{"x":522,"y":180},"state":-1,"viewType":"Text"}}}},"currentTask":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":50,"y":50},"state":0,"viewType":"Text"}},"commonData":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":75,"y":75}},"children":{"fileTypeList":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":555,"height":325},"posInfo":{"x":35,"y":53},"state":-1,"viewType":"JSON"}},"fileTypeLookupTable":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":660,"height":300},"posInfo":{"x":32,"y":99},"state":-1,"viewType":"JSON"}},"getFileTypeName":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":400,"height":400},"posInfo":{"x":31,"y":150},"state":-1,"viewType":"Code"}},"getSessionKey":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":429,"height":110},"posInfo":{"x":36,"y":279},"state":-1,"viewType":"Code"}},"getParamTable":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":361,"height":115},"posInfo":{"x":35,"y":331},"state":-1,"viewType":"Code"}},"fileInfo":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":657,"y":47}},"children":{"mfsBaseUrl":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":405,"height":50},"posInfo":{"x":14,"y":12},"state":0,"viewType":"Text"}},"getUploadType":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":583,"height":114},"posInfo":{"x":508,"y":57},"state":0,"viewType":"Code"}},"getCommunityIdentifier":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":369,"height":61},"posInfo":{"x":444,"y":247},"state":-1,"viewType":"Code"}},"COMMUNITY_PREFIX":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":28,"y":197},"state":-1,"viewType":"Text"}},"getCustomerIdentifier":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":741,"height":21},"posInfo":{"x":446,"y":288},"state":-1,"viewType":"Code"}},"customerAuthToPathName":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":28,"y":105},"state":-1,"viewType":"Text"}},"urlFormatLookupTable":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":706,"height":452},"posInfo":{"x":418,"y":42},"state":0,"viewType":"JSON"}},"overrideSectionLookupTable":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":420,"height":132},"posInfo":{"x":711,"y":431},"state":0,"viewType":"JSON"}},"getUrlParams":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":812,"height":517},"posInfo":{"x":834,"y":357},"state":-1,"viewType":"Code"}},"comFileUrlFormatString":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":380,"height":63},"posInfo":{"x":21,"y":262},"state":0,"viewType":"Text"}},"getMetaFileUrl":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":741,"height":400},"posInfo":{"x":473,"y":222},"state":0,"viewType":"Code"}},"getComFileUrl":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":715,"height":400},"posInfo":{"x":679,"y":700},"state":-1,"viewType":"Code"}},"getMetaFileInfo":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":529,"height":400},"posInfo":{"x":43,"y":395},"state":0,"viewType":"Code"}}}}}},"completed":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":100,"y":100}},"children":{"resetControl":{"type":"apogeeapp.app.CustomControlComponent","windowState":{"sizeInfo":{"width":360,"height":91},"posInfo":{"x":62,"y":16},"state":0,"viewType":"Output"},"resource":{"html":"<input type=\"button\" id=\"completed_reset\" value=\"Reset\"></input>","onLoad":"this.resetButton = document.getElementById(\"completed_reset\");\nthis.initialized = true;\n\nvar instance = this;\nthis.resetButton.onclick = function() {\n    instance.onReset();\n}","constructorAddition":"this.onReset = function() {\n\n    var clearTaskList = [\n        [\"loadCid\"],\n        [\"upload\"],\n        [\"completed\"]\n    ];\n    taskAppModule.clearTasksAndRestartFrom(mode.getMessenger(),clearTaskList,[\"loadCid\"]);\n}","setData":""}},"result":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":253,"height":77},"posInfo":{"x":510,"y":39},"state":0,"viewType":"Text"}},"state":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":290,"height":136},"posInfo":{"x":508,"y":167},"state":0,"viewType":"Text"}}}},"loadCid":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":82,"y":74}},"children":{"state":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":286,"height":74},"posInfo":{"x":831,"y":28},"state":0,"viewType":"Text"}},"result":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":289,"height":71},"posInfo":{"x":830,"y":152},"state":0,"viewType":"Text"}},"cidControl":{"type":"apogeeapp.app.CustomControlComponent","windowState":{"sizeInfo":{"width":749,"height":375},"posInfo":{"x":54,"y":58},"state":0,"viewType":"Output"},"resource":{"html":"CID: <input type=\"text\" id=\"cid_text\"></input>\n<br><br>\n<input type=\"button\" id=\"cid_submit\" value=\"Submit\"></input>\n<input type=\"button\" id=\"cid_cancel\" value=\"Cancel\"></input>","onLoad":"this.textInput = document.getElementById(\"cid_text\");\nthis.submitButton = document.getElementById(\"cid_submit\");\nthis.cancelButton = document.getElementById(\"cid_cancel\");\nthis.initialized = true;\n\nvar instance = this;\nthis.submitButton.onclick = () => instance.onSubmit();\nthis.cancelButton.onclick = () => instance.onCancel();","constructorAddition":"this.textInput = null;\nthis.submitButton = null;\nthis.newLogingButton = null;\nthis.initialized = false;\n\nthis.onSubmit = function() {\n    if(!this.initialized) return;\n    \n    var cidString = this.textInput.value.trim();\n    if(cidString.length === 0) {\n        alert(\"Invalid CID value.\");\n        return;\n    }\n    \n    if(!isFinite(cidString)) {\n        alert(\"Invalid CID value\");\n        return;\n    }\n    \n    var data = {}\n    data.cid = Number(cidString);\n    \n    taskAppModule.taskCompleted(mode.getMessenger(),[\"loadCid\"],[\"upload\"],data);\n}\n\nthis.onCancel = function() {\n    taskAppModule.taskCanceled(mode.getMessenger(),[\"loadCid\"],[\"login\"]);\n}"}}}},"selectCidPostProcess":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":125,"y":125}},"children":{"sessionKey":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":503,"height":37},"posInfo":{"x":38,"y":26},"state":-1,"viewType":"Text"}},"cid":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":148,"height":29},"posInfo":{"x":38,"y":68},"state":0,"viewType":"Text"}},"comFileResponse":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":913,"height":449},"posInfo":{"x":31,"y":173},"state":-1,"viewType":"JSON"}},"comFileRecord":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":646,"height":259},"posInfo":{"x":30,"y":217},"state":-1,"viewType":"JSON"}},"metaFileRecordMap":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":665,"height":145},"posInfo":{"x":424,"y":131},"state":-1,"viewType":"JSON"}},"getMetaFileRecord":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":488,"height":244},"posInfo":{"x":429,"y":84},"state":-1,"viewType":"Code"}},"metaFileInfo":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":722,"height":314},"posInfo":{"x":30,"y":330},"state":-1,"viewType":"Formula"}},"outputFile":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":678,"height":551},"posInfo":{"x":433,"y":265},"state":-1,"viewType":"Formula"}},"comFileOverrideEntries":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":756,"height":312},"posInfo":{"x":31,"y":269},"state":-1,"viewType":"JSON"}},"outputUrl":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":774,"height":300},"posInfo":{"x":430,"y":314},"state":-1,"viewType":"Text"}}}}}},"micemetarDataAccess":{"type":"apogeeapp.app.FolderComponent","children":{"createRecord":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":560,"height":321},"posInfo":{"x":33,"y":368},"state":-1,"viewType":"Private"}},"recordsToCreateInstructions":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":834,"height":391},"posInfo":{"x":30,"y":472},"state":-1,"viewType":"Code"}},"createCommitBody":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":568,"height":400},"posInfo":{"x":629,"y":225},"state":-1,"viewType":"Code"}},"createRequestOptions":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":523,"height":254},"posInfo":{"x":822,"y":379},"state":-1,"viewType":"Code"}},"host":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":353,"height":71},"posInfo":{"x":16,"y":6},"state":-1,"viewType":"Text"}},"commitUrl":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":433,"height":107},"posInfo":{"x":14,"y":98},"state":-1,"viewType":"Text"}},"requestUrl":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":450,"height":68},"posInfo":{"x":14,"y":58},"state":-1,"viewType":"Formula"}},"dataSetInfo":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":882,"height":611},"posInfo":{"x":317,"y":144},"state":-1,"viewType":"Text"}},"createUpdateInstruction":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":1002,"height":655},"posInfo":{"x":37,"y":247},"state":-1,"viewType":"Code"}},"createCreateInstruction":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":994,"height":643},"posInfo":{"x":39,"y":209},"state":-1,"viewType":"Code"}},"getFieldErrString":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":512,"height":68},"posInfo":{"x":761,"y":616},"state":-1,"viewType":"Code"}},"getRecordErrString":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":400,"height":81},"posInfo":{"x":762,"y":664},"state":-1,"viewType":"Code"}},"createDeleteInstruction":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":678,"height":540},"posInfo":{"x":36,"y":289},"state":-1,"viewType":"Code"}},"getRecordInfo":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":480,"height":400},"posInfo":{"x":818,"y":427},"state":-1,"viewType":"Code"}},"combinedEntriesToInstructionList":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":721,"height":524},"posInfo":{"x":31,"y":516},"state":-1,"viewType":"Private"}},"getCommitPromise":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":569,"height":109},"posInfo":{"x":316,"y":26},"state":-1,"viewType":"Code"}},"getRequestPromise":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":546,"height":89},"posInfo":{"x":315,"y":67},"state":-1,"viewType":"Code"}},"customRequestUrl":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":17,"y":142},"state":-1,"viewType":"Formula"}},"getCustomRequestPromise":{"type":"apogeeapp.app.FunctionComponent","windowState":{"sizeInfo":{"width":668,"height":88},"posInfo":{"x":317,"y":104},"state":-1,"viewType":"Code"}}}}}}