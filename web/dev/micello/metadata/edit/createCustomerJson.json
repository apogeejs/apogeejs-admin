{"fileType":"apogee app js workspace","version":"0.40","references":[],"workspace":{"fileType":"apogee workspace","version":0.2,"name":"createCustomerJson","data":{"name":"Model","type":"apogee.Folder","children":{"COLUMNS":{"name":"COLUMNS","type":"apogee.JsonTable","updateData":{"data":["Customer Name","MFS Path Name","Auth String"],"description":""}},"JSON_LABELS":{"name":"JSON_LABELS","type":"apogee.JsonTable","updateData":{"data":["customerName","pathName","authString"],"description":""}},"CreateCustomerFile":{"name":"CreateCustomerFile","type":"apogee.Folder","children":{"INSTRUCTIONS":{"name":"INSTRUCTIONS","type":"apogee.JsonTable","updateData":{"data":"CREATE CUSTOMER FILE:\n\n-- Working in Excel, update the customer file. If needed \ncreate in input for Excel using \"CREATE EXCEL DATA\" below.\n-- Paste the Excel data, with header row, into the grid\ntitled \"inputGrid\".\n-- The output file will be shown in the table \"outputJson\".\nCopy this to a file and upload to the appropriate URL.\n\nCREATE EXCEL DATA:\n\n-- Open the folder \"CreateExcelData\".\n-- Verify the URL matches the customer file you are using.\n-- The Excel input data matching that file is shown in the \ntable \"outputGrid\". Copy and paste this into Excel, including the\nheader row.","description":""}},"inputGrid":{"name":"inputGrid","type":"apogee.JsonTable","updateData":{"data":[["Customer Name","MFS Path Name","Auth String"]],"description":""}},"outputJson":{"name":"outputJson","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var process = (row,index) => {\n    var entry = {};\n    row.forEach( (element,index) => entry[JSON_LABELS[index]] = element);\n    return entry;\n}\n\nvar json = inputGrid.map(process);\n\n//get rid of heading row if needed\nif( JSON_LABELS.every( (element,index) => (json[0][element] == COLUMNS[index]) ) ) {\n    json.shift();\n}\n\nreturn json;","supplementalCode":"","description":""}}}},"CreateExcelData":{"name":"CreateExcelData","type":"apogee.Folder","children":{"inputJson":{"name":"inputJson","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"return apogee.net.jsonRequest(customerFileUrl);","supplementalCode":"","description":""}},"outputGrid":{"name":"outputGrid","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var process = entry =>  JSON_LABELS.map( element => entry[element] );\n\nvar rows = inputJson.map(process);\n\n//add the headings\nrows.unshift(COLUMNS);\nreturn rows;","supplementalCode":"","description":""}},"customerFileUrl":{"name":"customerFileUrl","type":"apogee.JsonTable","updateData":{"data":"https://eng.micello.com/apogee/data/customerJson.json","description":""}},"NOTES":{"name":"NOTES","type":"apogee.JsonTable","updateData":{"data":"Here a data grid for input into Excel is \ncreated based on the current customer file, \nspecified by the given URL.","description":""}}}}}}},"components":{"type":"apogeeapp.app.FolderComponent","treeState":1,"children":{"COLUMNS":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":317,"height":53},"posInfo":{"x":516,"y":11},"state":-1,"viewType":"Data"},"dataView":"Colorized"},"JSON_LABELS":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":-21},"posInfo":{"x":716,"y":9},"state":-1,"viewType":"Data"},"dataView":"Colorized"},"CreateCustomerFile":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":25,"y":25}},"tabOpen":true,"treeState":1,"children":{"INSTRUCTIONS":{"type":"apogeeapp.app.TextComponent","windowState":{"sizeInfo":{"width":550,"height":246},"posInfo":{"x":676,"y":52},"state":0,"viewType":"Text"}},"inputGrid":{"type":"apogeeapp.app.GridTableComponent","windowState":{"sizeInfo":{"width":524,"height":782},"posInfo":{"x":47,"y":34},"state":0,"viewType":"Grid"}},"outputJson":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":525,"height":253},"posInfo":{"x":681,"y":363},"state":0,"viewType":"Data"},"dataView":"Colorized"}}},"CreateExcelData":{"type":"apogeeapp.app.FolderComponent","windowState":{"posInfo":{"x":12,"y":90}},"treeState":1,"children":{"inputJson":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":403,"height":214},"posInfo":{"x":44,"y":159},"state":0,"viewType":"Data"},"dataView":"Colorized"},"outputGrid":{"type":"apogeeapp.app.GridTableComponent","windowState":{"sizeInfo":{"width":718,"height":663},"posInfo":{"x":625,"y":49},"state":0,"viewType":"Grid"}},"customerFileUrl":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":540,"height":46},"posInfo":{"x":45,"y":51},"state":0,"viewType":"Data"},"dataView":"Colorized"},"NOTES":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":372,"height":117},"posInfo":{"x":70,"y":445},"state":0,"viewType":"Data"},"dataView":"Text Data"}}}}},"activeTabMember":"Model.CreateCustomerFile"}