{"name":"CloudTest","fileType":"hax workspace","jsLinks":["https://apis.google.com/js/client.js"],"cssLinks":[],"workspace":{"name":"CloudTest","fileType":"hax workspace","version":0.2,"data":{"name":"CloudTest","type":"hax.Folder","children":{"Load":{"name":"Load","type":"hax.Control","updateData":{"argList":["resource"],"functionBody":"resource.setCallbacks(onDownloadPress,onUploadPress);","supplementalCode":"\r\n\r\nfunction onDownloadPress() {\r\n    getAuthAndDoAction(doDownload);\r\n}\r\n\r\n// function onUploadPress() {\r\n//     if(client === null) {\r\n//         doAfterClientLoad = doUpload;\r\n//         loadClient();\r\n//     }\r\n//     else {\r\n//         client.then(doUpload);\r\n//     }\r\n// }\r\n\r\n// Your Client ID can be retrieved from your project in the Google\r\n// Developer Console, https://console.developers.google.com\r\nAIzaSyADw5jVBXEW2XEVlr5XVSsgH1frCXBohQE\r\nvar CLIENT_ID = '933018598900-o6ejkguvna42eu66epreehm5nuirocua.apps.googleusercontent.com'; //intransix\r\n//var CLIENT_ID = '105795106133-2s6hcm7d2hoombjmkjgo4a86bi2gsnj9.apps.googleusercontent.com'; //micello\r\n\r\nvar SCOPES = [\"https://www.googleapis.com/auth/spreadsheets\"];\r\n\r\n\r\n/**\r\n * Check if current user has authorized this application.\r\n */\r\nfunction getAuthAndDoAction(clientAction) {\r\n    var nextStep = function(authResult) {\r\n        handleAuthResult(authResult,clientAction);\r\n    };\r\n    gapi.auth.authorize(\r\n            {\r\n                \"client_id\": CLIENT_ID,\r\n                \"scope\": SCOPES.join(' '),\r\n                \"immediate\": false\r\n            },\r\n            nextStep\r\n    );\r\n}\r\n\r\n/**\r\n * Handle response from authorization server.\r\n *\r\n * @param {Object} authResult Authorization result.\r\n */\r\nfunction handleAuthResult(authResult,clientAction) {\r\n    if (authResult && !authResult.error) {\r\n        loadSheetsApi(clientAction);\r\n    } else {\r\n        alert(\"Authorization failed: \" + authResult.error);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Load Sheets API client library.\r\n */\r\nfunction loadSheetsApi(clientAction) {\r\n    var discoveryUrl = 'https://sheets.googleapis.com/$discovery/rest?version=v4';\r\n    var temp = gapi.client.load(discoveryUrl)\r\n    temp.then(clientAction);\r\n}\r\n\r\nfunction doDownload() {\r\n    try {\r\n        gapi.client.sheets.spreadsheets.values.get({\r\n            //\"spreadsheetId\": '1xM9hFvTs69baR6v9jI3eMa2SLuDBTFkNRIEdUJh58xY',\r\n            \"spreadsheetId\": \"1VlcMRBzYsalrRw4E9W2D5c6-cowftX5QY6w4gbjFUWE\",\r\n            \"range\": 'Sheet1!A1:G',\r\n        }).then(downloadResult,errorResult);\r\n    }\r\n    catch(error) {\r\n        alert(\"Error: \" + error);\r\n    }\r\n}\r\n\r\nfunction doUpload() {\r\n    var uploadData = {};\r\n    //uploadData.spreadsheetId = '1xM9hFvTs69baR6v9jI3eMa2SLuDBTFkNRIEdUJh58xY';\r\n    uploadData.spreadsheetId = '1VlcMRBzYsalrRw4E9W2D5c6-cowftX5QY6w4gbjFUWE';\r\n    uploadData.valueInputOption=\"USER_ENTERED\";\r\n    uploadData.range = 'Sheet1!A1:G';\r\n    uploadData.values = grid;\r\n    var loadData = gapi.client.sheets.spreadsheets.values.update(uploadData);\r\n    loadData.then(uploadResult,errorResult);\r\n}\r\n\r\n\r\n\r\nfunction downloadResult(response) {\r\n    var range = response.result;\r\n    if (range.values.length > 0) {\r\n        setTableData(range.values);\r\n    } else {\r\n        alert('No data found.');\r\n    }\r\n}\r\n\r\nfunction uploadResult(response) {\r\n    alert(JSON.stringify(response));\r\n}\r\n\r\nfunction errorResult(response) {\r\n    alert('Error: ' + response.result.error.message);\r\n}\r\n\r\nfunction setTableData(data) {\r\n    var workspace = app.getWorkspace(\"CloudTest\");\r\n    var rootFolder = workspace.getRoot();\r\n    var gridTable = rootFolder.lookupChildFromPath([\"grid\"]);\r\n    if(gridTable) {\r\n        var actionResponse = hax.updatemember.updateData(gridTable,data);\r\n        if(actionResponse.getSuccess()) {\r\n            //alert(\"Data loaded!\");\r\n        }\r\n        else {\r\n            alert(actionResponse.getErrorMsg());\r\n        }\r\n    }\r\n    \r\n}"}},"grid":{"name":"grid","type":"hax.JsonTable","updateData":{"data":[["kjhgkjhg","3:14:00","10,000 Maniacs","Blind Man's Zoo","Pop","","8"],["Sentimientos","4:31:00","Andres Linetzky & Ernesto Romeo","Chai Room","Reggae","","10"],["Slipped away","3:34:00","AVRil Lavigne","My worldl","Blues","","10"],["Allentown","3:50:00","Billy Joel","The Essential Billy Joel","Rock"],["An Innocent Man","5:18:00","Billy Joel","An Innocent Man","Soft Rock","","10"],["Careless Talk","3:47:00","Billy Joel","An Innocent Man","Soft Rock"],["Christie Lee","3:30:00","Billy Joel","An Innocent Man","Soft Rock"],["Easy  OLD END!","4:06:00","Billy Joel","An Innocent Man","Soft Rock"]]}}}}},"components":{"Load":{"key":"CloudTest:Load","type":"haxapp.app.CustomControlComponent","coordInfo":{"x":105,"y":0,"width":915,"height":870},"windowState":0,"resource":{"html":"","customizeScript":"var resource = {};\r\n\r\nresource.setComponent = function(component) {\r\n    var loadButton = document.createElement(\"input\");\r\n    loadButton.setAttribute(\"type\",\"button\");\r\n    loadButton.value = \"Download\";\r\n    loadButton.onclick = function() {\r\n        if(resource.onDownload) {\r\n            resource.onDownload();\r\n        }\r\n    }\r\n    \r\n    var saveButton = document.createElement(\"input\");\r\n    saveButton.setAttribute(\"type\",\"button\");\r\n    saveButton.value = \"Upload\";\r\n    saveButton.onclick = function() {\r\n        if(resource.onUpload) {\r\n            resource.onUpload();\r\n        }\r\n    }\r\n    \r\n    var container = component.getOutputElement();\r\n    container.innerHTML = \"\";\r\n    container.appendChild(loadButton);\r\n    container.appendChild(saveButton);\r\n}\r\n\r\nresource.setCallbacks = function(onDownload,onUpload) {\r\n    resource.onDownload = onDownload;\r\n    resource.onUpload = onUpload;\r\n}\r\n\r\nreturn resource;\r\n","supplementalCode":"","css":""}},"grid":{"key":"CloudTest:grid","type":"haxapp.app.GridTableComponent","coordInfo":{"x":665,"y":49,"width":908,"height":637},"windowState":0}}}