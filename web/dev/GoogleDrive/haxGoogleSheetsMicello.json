{"name":"CloudTest","fileType":"apogee workspace","jsLinks":["https://apis.google.com/js/client.js","/apogee/dev/GoogleDrive/GoogleSheetsWrapper.js"],"cssLinks":[],"workspace":{"name":"CloudTest","fileType":"apogee workspace","version":0.2,"data":{"name":"CloudTest","type":"apogee.Folder","children":{"Load":{"name":"Load","type":"apogee.Control","updateData":{"argList":["resource"],"functionBody":"resource.setCallbacks(onDownloadPress,onSavePress);","supplementalCode":"\r\n\r\nvar CLIENT_ID = '933018598900-o6ejkguvna42eu66epreehm5nuirocua.apps.googleusercontent.com'; //intransix\r\nvar spreadsheetId = '1VlcMRBzYsalrRw4E9W2D5c6-cowftX5QY6w4gbjFUWE';\r\nvar range = 'Sheet1!A1:G'; \r\n\r\n//micello\r\n//var CLIENT_ID = '105795106133-2s6hcm7d2hoombjmkjgo4a86bi2gsnj9.apps.googleusercontent.com'; //micello\r\n//spreadsheetId = '1xM9hFvTs69baR6v9jI3eMa2SLuDBTFkNRIEdUJh58xY',\r\n//range = 'Sheet1!A1:G'\r\n\r\nfunction onDownloadPress() {\r\n    var downloadAction = function() {\r\n        getRange(spreadsheetId,range,onDownload);\r\n    }\r\n    \r\n    initiateAction(downloadAction,CLIENT_ID);\r\n}\r\n\r\nfunction onSavePress() {\r\n    var date = new Date();\r\n    var name = date.toUTCString();\r\n    var addRange = name + \"!A1:G\";\r\n    var uploadAction = function() {\r\n        doUpload(spreadsheetId,addRange,grid,onResult);\r\n    }\r\n    var onAdd = function(response) {\r\n        if(response.status === 200) {\r\n            initiateAction(uploadAction,CLIENT_ID);\r\n        }\r\n        else {\r\n            alert(\"Error in add: \" + JSON.stringify(response));\r\n        }\r\n    }\r\n    var addAction = function() {\r\n        addNewSheet(spreadsheetId,name,onAdd);\r\n    }\r\n    \r\n    initiateAction(addAction,CLIENT_ID);\r\n}\r\n\r\nfunction onUploadPress() {\r\n    \r\n    \r\n    initiateAction(uploadAction,CLIENT_ID);\r\n}\r\n\r\n\r\nfunction onDownload(response) {\r\n    var range = response.result;\r\n    if (range.values.length > 0) {\r\n        setTableData(range.values);\r\n    } else {\r\n        alert('No data found.');\r\n    }\r\n}\r\n\r\nfunction setTableData(data) {\r\n    var workspace = app.getWorkspace(\"CloudTest\");\r\n    var rootFolder = workspace.getRoot();\r\n    var gridTable = rootFolder.lookupChildFromPathArray([\"grid\"]);\r\n    if(gridTable) {\r\n        var actionResponse = apogee.updatemember.updateData(gridTable,data);\r\n        if(actionResponse.getSuccess()) {\r\n            //alert(\"Data loaded!\");\r\n        }\r\n        else {\r\n            alert(actionResponse.getErrorMsg());\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nfunction onResult(response) {\r\n    alert(JSON.stringify(response));\r\n}\r\n\r\n\r\n\r\n"}},"grid":{"name":"grid","type":"apogee.JsonTable","updateData":{"data":[["kjhgkjhg","3:14:00","10,000 Maniacs","Blind Man's Zoo","Pop","","8"],["Sentimientos","4:31:00","Andres Linetzky & Ernesto Romeo","Chai Room","Reggae","","10"],["Slipped away","3:34:00","AVRil Lavigne","My worldl","Blues","","10"],["Allentown","3:50:00","Billy Joel","The Essential Billy Joel","Rock"],["An Innocent Man","5:18:00","Billy Joel","An Innocent Man","Soft Rock","","10"],["Careless Talk","3:47:00","Billy Joel","An Innocent Man","Soft Rock"],["Christie Lee","3:30:00","Billy Joel","An Innocent Man","Soft Rock"],["Easy  OLD END!","4:06:00","Billy Joel","An Innocent Man","Soft Rock"]]}}}}},"components":{"Load":{"key":"CloudTest:Load","type":"apogeeapp.app.CustomControlComponent","coordInfo":{"x":99,"y":47,"width":859,"height":416},"windowState":0,"resource":{"html":"","customizeScript":"var resource = {};\r\n\r\nresource.setComponent = function(component) {\r\n    var loadButton = document.createElement(\"input\");\r\n    loadButton.setAttribute(\"type\",\"button\");\r\n    loadButton.value = \"Download\";\r\n    loadButton.onclick = function() {\r\n        if(resource.onDownload) {\r\n            resource.onDownload();\r\n        }\r\n    }\r\n    \r\n    var saveButton = document.createElement(\"input\");\r\n    saveButton.setAttribute(\"type\",\"button\");\r\n    saveButton.value = \"Save\";\r\n    saveButton.onclick = function() {\r\n        if(resource.onSave) {\r\n            resource.onSave();\r\n        }\r\n    }\r\n    \r\n    var container = component.getOutputElement();\r\n    container.innerHTML = \"\";\r\n    container.appendChild(loadButton);\r\n    container.appendChild(saveButton);\r\n}\r\n\r\nresource.setCallbacks = function(onDownload,onSave) {\r\n    resource.onDownload = onDownload;\r\n    resource.onSave = onSave;\r\n}\r\n\r\nreturn resource;\r\n","supplementalCode":"","css":""}},"grid":{"key":"CloudTest:grid","type":"apogeeapp.app.GridTableComponent","coordInfo":{"x":395,"y":329,"width":908,"height":637},"windowState":0}}}