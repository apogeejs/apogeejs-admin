{"fileType":"apogee app js workspace","version":"0.40","references":[{"url":"https://apis.google.com/js/api.js","entryType":"js link"}],"workspace":{"fileType":"apogee workspace","version":0.2,"name":"GoogleSpreadsheetAccess","data":{"name":"Model","type":"apogee.Folder","children":{"spreadsheetSource":{"name":"spreadsheetSource","type":"apogee.JsonTable","updateData":{"data":{"spreadsheetId":"1tDZOBKNGikLuLwfhf32XJ-vso51mF_sChh4FxWGhIbs","range":"Sheet3!A1:D"},"description":""}},"data":{"name":"data","type":"apogee.JsonTable","updateData":{"data":[["Map Products Code","File Group","Auth Strings","Product ID"],["SERVICE_V5_MAP_JSON","/v5_nav/json-enh","enhnavjson_[cid]","ENH_JSON_NAV"],["SERVICE_V5_NAV","/v5_nav/json-enh","enhnavjson_[cid]","ENH_JSON_NAV"],["SERVICE_V5_MAP_JSON","/v5_nav/bin-enh","enhnav_[cid]","ENH_NAV"],["SERVICE_V5_NAV","/v5_nav/bin-enh","enhnav_[cid]","ENH_NAV"],["SERVICE_GEO_JSON","/geojson","geojson_[cid]","GEOJSON"],["SERVICE_V5_GEOM_INFO","/v5_info","info_[cid]","INFO"],["SERVICE_V4_MAP_JSON","/v4_nav/json","navjson_[cid]","JSON_NAV"],["SERVICE_V3_MAP_JSON","/v3_nav/json","navjson_[cid]","JSON_NAV"],["SERVICE_V5_MAP_JSON","/v5_nav/json","navjson_[cid]","JSON_NAV"],["SERVICE_V5_NAV","/v5_nav/json","navjson_[cid]","JSON_NAV"],["SERVICE_V4_MAP_JSON","/v4_map","sdk_[cid]","SDK"],["SERVICE_V4_MAP_JSON","/v4_nav/bin","nav_[cid]","SDK"],["SERVICE_V3_MAP_JSON","/v3_map","sdk_[cid]","SDK"],["SERVICE_V3_MAP_JSON","/v3_nav/bin","nav_[cid]","SDK"],["SERVICE_V5_MAP_JSON","/v5_map","sdk_[cid]","SDK"],["SERVICE_V5_MAP_JSON","/v5_nav/bin","nav_[cid]","SDK"],["SERVICE_V5_NAV","/v5_nav/bin","nav_[cid]","SDK"],["SERVICE_V3_NAV"],["SERVICE_V3_DATA_XML"],["SERVICE_BASE_DATA"],["SERVICE_LO_RES_IMAGE"],["SERVICE_HI_RES_IMAGE"],["SERVICE_KML"],["SERVICE_SVG_PLAIN"],["SERVICE_SVG_PRETTY"]],"description":""}},"SpreadsheetLoader":{"name":"SpreadsheetLoader","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var data = {};\ndata.spreadsheetSource = spreadsheetSource;\n\nreturn data;","supplementalCode":"","description":""}}}}},"components":{"type":"apogeeapp.app.FolderComponent","tabOpen":true,"treeState":1,"children":{"spreadsheetSource":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":640,"height":93},"posInfo":{"x":78,"y":56},"state":0,"viewType":"Data"},"dataView":"Colorized"},"data":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":570,"height":548},"posInfo":{"x":575,"y":212},"state":0,"viewType":"Data"},"dataView":"Colorized"},"SpreadsheetLoader":{"type":"apogeeapp.app.CustomControlComponent","windowState":{"sizeInfo":{"width":403,"height":132},"posInfo":{"x":92,"y":226},"state":0,"viewType":"Output"},"resource":{"html":"<h2>Google Spreadsheet Access</h2>\r\n<button id=\"authorize-button\" style=\"display: none;\" class=\"spreadsheetLoaderButton\">Authorize</button>\r\n<button id=\"load-button\" style=\"display: none;\" class=\"spreadsheetLoaderButton\">Load Data</button>\r\n<button id=\"signout-button\" style=\"display: none;\" class=\"spreadsheetLoaderButton\">Sign Out</button>","onLoad":"this.authorizeButton = document.getElementById('authorize-button');\nthis.loadButton = document.getElementById('load-button');\nthis.signoutButton = document.getElementById('signout-button');\n\nthis.authorizeButton.onclick = () => this.handleAuthClick();\nthis.loadButton.onclick = () => this.handleLoadClick();\nthis.signoutButton.onclick = () => this.handleSignoutClick();\n\nthis.handleClientLoaded();","constructorAddition":"var clientId = \"105795106133-h28kuih6942dlta6cvhi01bn026ud9aa.apps.googleusercontent.com\";\nvar apiKey = \"AIzaSyBx6k8wKCGM2FAk-WlDpXzCtFJ0k6yfmXQ\";\n\n// Array of API discovery doc URLs for APIs used by the quickstart\nvar DISCOVERY_DOCS = [\"https://sheets.googleapis.com/$discovery/rest?version=v4\"];\n\n// Authorization scopes required by the API; multiple scopes can be\n// included, separated by spaces.\nvar SCOPES = \"https://www.googleapis.com/auth/spreadsheets.readonly\";\n\nthis.handleClientLoaded = function() {\n    if((!gapi)||(!gapi.load)) {\n        alert(\"Google access API not loaded\");\n        return;\n    }\n    \n    if(gapi.auth2) {\n        if(gapi.auth2.getAuthInstance()) {\n            this.manageSignInState();\n        }\n        else {\n            this.initClient();\n        }\n    }\n    else {\n        gapi.load('client:auth2',() => this.initClient());\n    }\n}\n\nthis.handleClientUnloaded = function() {\n    //remove listener!!!?\n}\n\nthis.initClient = function() {\n    gapi.client.init({\n        apiKey: apiKey,\n        clientId: clientId,\n        discoveryDocs: DISCOVERY_DOCS,\n        scope: SCOPES\n    }).then( () => this.manageSignInState() );\n}\n\nthis.manageSignInState = function() {\n\n    // Listen for sign-in state changes.\n    gapi.auth2.getAuthInstance().isSignedIn.listen(isSignedIn => this.updateSigninStatus(isSignedIn));\n\n    // Handle the initial sign-in state.\n    this.updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());\n}\n\nthis.updateSigninStatus = function(isSignedIn) {\n    if(isSignedIn) {\n        this.authorizeButton.style.display = 'none';\n        this.loadButton.style.display = 'block';\n        this.signoutButton.style.display = 'block';\n    } \n    else {\n        this.authorizeButton.style.display = 'block';\n        this.loadButton.style.display = 'none';\n        this.signoutButton.style.display = 'none';\n    }\n}\n\n/**\n*  Sign in the user upon button click.\n*/\nthis.handleAuthClick = function(event) {\n    gapi.auth2.getAuthInstance().signIn();\n}\n\n/**\n*  Sign out the user upon button click.\n*/\nthis.handleSignoutClick = function(event) {\n    gapi.auth2.getAuthInstance().signOut();\n}\n\n\n/**\n* Print the names and majors of students in a sample spreadsheet:\n* https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit\n*/\nthis.handleLoadClick = function() {\n    if(!gapi.auth2.getAuthInstance().isSignedIn.get()) {\n        alert(\"You are not logged into Google Sheets!\");\n        return;\n    }\n    \n    var appendPre = function(data) {\n        console.log(data);\n    }\n    \n    gapi.client.sheets.spreadsheets.values.get(this.data.spreadsheetSource).then(function(response) {\n        var data = response.result.values;\n        mode.getMessenger().dataUpdate(\"data\",data);\n    }, function(response) {\n        appendPre('Error: ' + response.result.error.message);\n    });\n}","setData":"this.data = data;","onUnload":"this.handleClientUnloaded();","css":".spreadsheetLoaderButton {\n    margin: 10px;\n}"},"destroyOnInactive":false}}},"activeTabMember":"Model"}