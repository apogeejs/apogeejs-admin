{"name":"WorkspaceConvert","fileType":"visicomp workspace","jsLinks":[],"cssLinks":[],"workspace":{"name":"WorkspaceConvert","fileType":"visicomp workspace","version":0.1,"data":{"name":"WorkspaceConvert","type":"visicomp.core.Folder","children":{"input":{"name":"input","type":"visicomp.core.JsonTable","updateData":{"data":{"name":"Home Costs","fileType":"visicomp workspace","jsLinks":["https://www.gstatic.com/charts/loader.js","../../app/test/GoogleChartComponent.js"],"cssLinks":[],"data":{"generalInfo":{"name":"generalInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":252,"height":148,"x":25,"y":4},"windowState":0,"data":{"initialSavings":200000,"monthlyAllowance":3000,"savingsReturnPercent":5,"inflationPercent":3}},"CALCULATION_DURATION_YEARS":{"name":"CALCULATION_DURATION_YEARS","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":259,"height":58,"x":298,"y":6},"windowState":0,"data":50},"homeScenario":{"name":"homeScenario","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":358,"height":213,"x":24,"y":170},"windowState":0,"data":{"homeCost":500000,"downpaymentPercent":20,"lengthYears":30,"ratePercent":3,"homeApprciationPercent":4,"propertyTaxPercent":1.3,"taxHomeValueGrowthPercent":1,"maintancePercent":1.3,"marginalTaxRatePercent":35}},"rentalScenario":{"name":"rentalScenario","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":357,"height":111,"x":19,"y":420},"windowState":0,"data":{"rentDollars":1500,"rentGrowthPercent":4}},"calculations":{"name":"calculations","type":"visicomp.app.visiui.FolderComponent","windowCoords":{"width":1222,"height":940,"x":618,"y":16},"windowState":-1,"children":{"own":{"name":"own","type":"visicomp.app.visiui.FolderComponent","windowCoords":{"width":858,"height":1073,"x":62,"y":24},"windowState":-1,"children":{"mortagePayment":{"name":"mortagePayment","type":"visicomp.app.visiui.FunctionComponent","windowCoords":{"width":200,"height":200,"x":539,"y":529},"windowState":-1,"argList":["loanAmount","lengthYears","ratePercent"],"functionBody":"var monthlyInterestRate = ratePercent/calculations.MONTHS_PER_YEAR/100;\nvar numberMonths = lengthYears * calculations.MONTHS_PER_YEAR;\n\nvar compoundFactor = Math.pow(1 + monthlyInterestRate,numberMonths);\n\nvar payment = loanAmount * \n    (monthlyInterestRate*compoundFactor) / \n    (compoundFactor - 1);\n    \nreturn payment;","supplementalCode":""},"payment":{"name":"payment","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":190,"height":60,"x":409,"y":21},"windowState":0,"functionBody":"var value;\nvar loanAmount = homeScenario.homeCost * (1 - homeScenario.downpaymentPercent/100);\n\nvalue = mortagePayment(loanAmount,\n    homeScenario.lengthYears,homeScenario.ratePercent);\nreturn value;\n\n","supplementalCode":""},"loanAmount":{"name":"loanAmount","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":132,"height":59,"x":229,"y":19},"windowState":0,"functionBody":"var value;\nvalue = homeScenario.homeCost - downpayment;\nreturn value;\n\n","supplementalCode":""},"downpayment":{"name":"downpayment","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":144,"height":68,"x":35,"y":17},"windowState":0,"functionBody":"var value;\nvalue = homeScenario.homeCost * homeScenario.downpaymentPercent/100;\nreturn value;\n\n","supplementalCode":""},"loanInfo":{"name":"loanInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":387,"height":171,"x":10,"y":96},"windowState":0,"functionBody":"var value;\nvar initialPrincipal = loanAmount;\nvar monthlyInterestRate = homeScenario.ratePercent/calculations.MONTHS_PER_YEAR/100;\n\nvalue = [];\nvar entry;\n\n\n//initial\nentry = {};\nentry.principal = initialPrincipal;\nentry.payment = 0;\nentry.interest = 0;\nvalue[0] = entry;\n\n//evolution\nvar prevEntry = entry;\nfor(var i = 1; i < calculations.NUMBER_MONTHS; i++) {\n    \n    entry = {};\n    entry.interest = prevEntry.principal * monthlyInterestRate;\n    var newPrincipalBeforePayment = prevEntry.principal + entry.interest;\n    \n    entry.payment = (newPrincipalBeforePayment > payment) ? payment : newPrincipalBeforePayment;\n    entry.principal = newPrincipalBeforePayment - entry.payment;\n\n    value.push(entry);\n    prevEntry = entry;\n}\nreturn value;\n\n","supplementalCode":""},"homeValueInfo":{"name":"homeValueInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":383,"height":167,"x":-25,"y":296},"windowState":0,"functionBody":"var value;\nvar initialHomeValue = homeScenario.homeCost;\nvar homeValueGrowthFactor = (1 + homeScenario.homeApprciationPercent/calculations.MONTHS_PER_YEAR/100);\nvar taxHomeValueGrowthFactor = (1 + homeScenario.taxHomeValueGrowthPercent/calculations.MONTHS_PER_YEAR/100);\n\n\nvalue = [];\nvar entry;\n\n//initial homeAssets\nentry = {};\nentry.homeValue = initialHomeValue;\nentry.taxHomeValue = initialHomeValue;\nvalue[0] = entry;\n\n//evolution\nvar prevEntry = entry;\nfor(var i = 0; i < calculations.NUMBER_MONTHS; i++) {\n    entry = {};\n\n    entry.homeValue = prevEntry.homeValue * homeValueGrowthFactor;\n    entry.taxHomeValue = prevEntry.taxHomeValue * taxHomeValueGrowthFactor;\n    \n    value.push(entry);\n    prevEntry = entry;\n}\nreturn value;\n\n","supplementalCode":""},"savingsInfo":{"name":"savingsInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":343,"height":174,"x":25,"y":509},"windowState":0,"functionBody":"var value;\nvar initialSavings = generalInfo.initialSavings - downpayment;\nvar savingsGrowthFactor = (1 + generalInfo.savingsReturnPercent/calculations.MONTHS_PER_YEAR/100);\n\nvalue = [];\n\nvalue[0] = initialSavings;\nfor(var i = 1; i < calculations.NUMBER_MONTHS; i++) {\n    value[i] = value[i-1] * savingsGrowthFactor + calculations.allowanceInfo[i] - homeCostsInfo[i].totalWithMortgage;\n}\nreturn value;\n\n","supplementalCode":""},"homeCostsInfo":{"name":"homeCostsInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":333,"height":182,"x":461,"y":107},"windowState":0,"functionBody":"var value;\nvar monthlyPropertyTaxPercent = homeScenario.propertyTaxPercent/calculations.MONTHS_PER_YEAR/100;\nvar monthlyMaintanenceFactor = homeScenario.maintancePercent/calculations.MONTHS_PER_YEAR/100;\nvar marginalTaxRate = homeScenario.marginalTaxRatePercent/100;\n\nvalue = [];\nvar entry;\n\n//initial homeAssets\nentry = {};\nentry.maintanence = 0;\nentry.taxCredit = 0;\nentry.propertyTax = 0;\nentry.totalWithMortgage = getTotalCosts(entry,loanInfo[0]);\nvalue[0] = entry;\n\n//evolution\nvar prevEntry = entry;\nfor(var i = 1; i < calculations.NUMBER_MONTHS; i++) {\n    entry = {};\n    loanInfoEntry = loanInfo[i];\n    homeValueEntry = homeValueInfo[i];\n\n    entry.propertyTax = homeValueEntry.taxHomeValue * monthlyPropertyTaxPercent;\n    entry.maintanence = homeValueEntry.homeValue * monthlyMaintanenceFactor;\n    entry.taxCredit = (loanInfoEntry.interest + entry.propertyTax) * marginalTaxRate; \n    entry.totalWithMortgage = getTotalCosts(entry,loanInfoEntry);\n    \n    value.push(entry);\n    prevEntry = entry;\n}\nreturn value;\n\n","supplementalCode":"function getTotalCosts(costsEntry,loanEntry) {\n    return costsEntry.maintanence + costsEntry.propertyTax +\n        loanEntry.payment - costsEntry.taxCredit;\n    \n}"},"totalAssets":{"name":"totalAssets","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":329,"height":154,"x":476,"y":324},"windowState":0,"functionBody":"var value;\nvalue = [];\nfor(var i = 0; i < calculations.NUMBER_MONTHS; i++) {\n    value[i] = savingsInfo[i] + homeValueInfo[i].homeValue - loanInfo[i].principal;\n}\nreturn value;\n\n","supplementalCode":""}}},"rent":{"name":"rent","type":"visicomp.app.visiui.FolderComponent","windowCoords":{"width":809,"height":597,"x":62,"y":82},"windowState":-1,"children":{"savingsInfo":{"name":"savingsInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":285,"height":223,"x":41,"y":196},"windowState":0,"functionBody":"var value;\nvar initialSavings = generalInfo.initialSavings;\nvar savingsGrowthFactor = (1 + generalInfo.savingsReturnPercent/calculations.MONTHS_PER_YEAR/100);\n\nvalue = [];\nvalue[0] = initialSavings;\nfor(var i = 1; i < calculations.NUMBER_MONTHS; i++) {\n    value[i] = value[i-1] * savingsGrowthFactor + calculations.allowanceInfo[i] - rentInfo[i];\n}\nreturn value;\n\n","supplementalCode":""},"rentInfo":{"name":"rentInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":298,"height":137,"x":41,"y":26},"windowState":0,"functionBody":"var value;\nvar initialRent = rentalScenario.rentDollars;\nvar rentGrowthFactor = (1 + rentalScenario.rentGrowthPercent/calculations.MONTHS_PER_YEAR/100);\n\nvalue = [];\nvalue[0] = initialRent;\nfor(var i = 1; i < calculations.NUMBER_MONTHS; i++) {\n    value[i] = value[i-1] * rentGrowthFactor;\n}\nreturn value;\n\n","supplementalCode":""}}},"MONTHS_PER_YEAR":{"name":"MONTHS_PER_YEAR","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":205,"height":62,"x":704,"y":64},"windowState":-1,"data":12},"NUMBER_MONTHS":{"name":"NUMBER_MONTHS","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":192,"height":60,"x":704,"y":16},"windowState":-1,"functionBody":"var value;\nvalue = CALCULATION_DURATION_YEARS * calculations.MONTHS_PER_YEAR;\nreturn value;\n\n","supplementalCode":""},"allowanceInfo":{"name":"allowanceInfo","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":265,"height":148,"x":307,"y":24},"windowState":0,"functionBody":"var value;\nvar initialAllowance = generalInfo.monthlyAllowance;\nvar allowanceGrowthFactor = (1 + generalInfo.inflationPercent/calculations.MONTHS_PER_YEAR/100);\n\nvalue = [];\n\nvalue[0] = initialAllowance;\nfor(var i = 1; i < calculations.NUMBER_MONTHS; i++) {\n    value[i] = value[i-1] * allowanceGrowthFactor;\n}\nreturn value;\n\n","supplementalCode":""},"chartInfo":{"name":"chartInfo","type":"visicomp.app.visiui.FolderComponent","windowCoords":{"width":819,"height":593,"x":50,"y":235},"windowState":0,"children":{"assetsData":{"name":"assetsData","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":327,"height":229,"x":408,"y":263},"windowState":0,"functionBody":"var value;\nvar loanInfo = calculations.own.loanInfo;\nvar homeInfo = calculations.own.homeValueInfo;\nvar homeSavingsInfo = calculations.own.savingsInfo;\nvar rentSavingsInfo = calculations.rent.savingsInfo;\nvar homelessSavingsInfo = calculations.homeless.savings;\n\nvar rows = [];\nvar columns = [];\n\ncolumns[0] = createColumn(\"number\",\"Time\");\ncolumns[1] = createColumn(\"number\",\"Loan\");\ncolumns[2] = createColumn(\"number\",\"Home\");\ncolumns[3] = createColumn(\"number\",\"Home-Savings\");\ncolumns[4] = createColumn(\"number\",\"Home-Total\");\ncolumns[5] = createColumn(\"number\",\"Rent-Savings\");\ncolumns[6] = createColumn(\"number\",\"Homeless-Savings\");\n\nfor(var i = 0; i < calculations.NUMBER_MONTHS; i++) {\n    rows[i] = [];\n    rows[i][0] = i;\n    rows[i][1] = loanInfo[i].principal;\n    rows[i][2] = homeInfo[i].homeValue;\n    rows[i][3] = homeSavingsInfo[i];\n    rows[i][4] = homeSavingsInfo[i] + homeInfo[i].homeValue - loanInfo[i].principal;\n    rows[i][5] = rentSavingsInfo[i];\n    rows[i][6] = homelessSavingsInfo[i];\n}\n\nvalue = {};\nvalue.rows = rows;\nvalue.columns = columns;\nreturn value;\n\n","supplementalCode":"function createColumn(type,name) {\n    var column = {};\n    column.type = type;\n    column.name = name;\n    return column;\n}"},"assetsOptions":{"name":"assetsOptions","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":324,"height":229,"x":409,"y":7},"windowState":0,"data":{"hAxis":{"title":"Months"},"vAxis":{"title":"Dollars"},"backgroundColor":"#f9f9f9","title":"Assets","width":900,"height":500}},"costsOptions":{"name":"costsOptions","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":324,"height":233,"x":56,"y":5},"windowState":0,"data":{"hAxis":{"title":"Months"},"vAxis":{"title":"Dollars"},"backgroundColor":"#f9f9f9","title":"Costs","width":900,"height":500}},"costsData":{"name":"costsData","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":326,"height":231,"x":55,"y":262},"windowState":0,"functionBody":"var value;\nvar loanInfo = calculations.own.loanInfo;\nvar homeInfo = calculations.own.homeCostsInfo;\nvar rentInfo = calculations.rent.rentInfo;\nvar homelessInfo = calculations.homeless.costs;\n\nvar rows = [];\nvar columns = [];\n\ncolumns[0] = createColumn(\"number\",\"Time\");\ncolumns[1] = createColumn(\"number\",\"Loan\");\ncolumns[2] = createColumn(\"number\",\"Home-Maint\");\ncolumns[3] = createColumn(\"number\",\"Home-Prop Tax\");\ncolumns[4] = createColumn(\"number\",\"Home-Tax Credit\");\ncolumns[5] = createColumn(\"number\",\"Home-Total\");\ncolumns[6] = createColumn(\"number\",\"Rent\");\ncolumns[7] = createColumn(\"number\",\"Homeless\");\n\nfor(var i = 0; i < calculations.NUMBER_MONTHS; i++) {\n    rows[i] = [];\n    rows[i][0] = i;\n    rows[i][1] = loanInfo[i].payment;\n    rows[i][2] = homeInfo[i].maintanence;\n    rows[i][3] = homeInfo[i].propertyTax;\n    rows[i][4] = -homeInfo[i].taxCredit;\n    rows[i][5] = homeInfo[i].totalWithMortgage;\n    rows[i][6] = rentInfo[i];\n    rows[i][7] = homelessInfo[i];\n}\n\nvalue = {};\nvalue.rows = rows;\nvalue.columns = columns;\nreturn value;\n\n","supplementalCode":"function createColumn(type,name) {\n    var column = {};\n    column.type = type;\n    column.name = name;\n    return column;\n}"}}},"homeless":{"name":"homeless","type":"visicomp.app.visiui.FolderComponent","windowCoords":{"width":690,"height":378,"x":58,"y":152},"windowState":-1,"children":{"costs":{"name":"costs","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":200,"height":200,"x":38,"y":19},"windowState":0,"functionBody":"var value;\nvalue = [];\nfor(var i = 0; i < calculations.NUMBER_MONTHS; i++) {\n    value[i] = 0;\n}\nreturn value;\n\n","supplementalCode":""},"savings":{"name":"savings","type":"visicomp.app.visiui.JsonTableComponent","windowCoords":{"width":200,"height":200,"x":267,"y":19},"windowState":0,"functionBody":"var value;\nvar initialSavings = generalInfo.initialSavings;\nvar savingsGrowthFactor = (1 + generalInfo.savingsReturnPercent/calculations.MONTHS_PER_YEAR/100);\n\nvalue = [];\nvalue[0] = initialSavings;\nfor(var i = 1; i < calculations.NUMBER_MONTHS; i++) {\n    value[i] = value[i-1] * savingsGrowthFactor + calculations.allowanceInfo[i] - costs[i];\n}\nreturn value;\n\n","supplementalCode":""}}}}},"assets":{"name":"assets","type":"visicomp.example.GoogleChartComponent","windowCoords":{"width":886,"height":555,"x":428,"y":92},"windowState":0,"argList":["resource"],"functionBody":"resource.setData(calculations.chartInfo.assetsData,\n    calculations.chartInfo.assetsOptions);","supplementalCode":""},"costs":{"name":"costs","type":"visicomp.example.GoogleChartComponent","windowCoords":{"width":933,"height":525,"x":568,"y":41},"windowState":0,"argList":["resource"],"functionBody":"resource.setData(calculations.chartInfo.costsData,\n    calculations.chartInfo.costsOptions);","supplementalCode":""}}}}},"workspaceData":{"name":"workspaceData","type":"visicomp.core.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = getFolderContents(input.data,getWorkspaceElement,input);\nreturn value;\n\n","supplementalCode":""}},"componentData":{"name":"componentData","type":"visicomp.core.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = getFolderContents(input.data,getComponentElement,input);\nreturn value;\n\n","supplementalCode":""}},"getComponentElement":{"name":"getComponentElement","type":"visicomp.core.FunctionTable","updateData":{"argList":["oldElement","parent"],"functionBody":"value = {};\n\nvar baseKey;\nif(parent.key) {\n    baseKey = parent.key + \".\";\n}\nelse {\n    baseKey = parent.name + \":\"\n}\nvalue.key = baseKey + oldElement.name;\nvalue.type = oldElement.type;\nvalue.coordInfo = oldElement.windowCoords;\nvalue.windowState = oldElement.windowState;\n\nreturn value;","supplementalCode":""}},"getWorkspaceElement":{"name":"getWorkspaceElement","type":"visicomp.core.FunctionTable","updateData":{"argList":["oldElement","parent"],"functionBody":"value = {};\nvalue.name = oldElement.name;\nvalue.type = getCoreType(oldElement.type);\n\nif(oldElement.children) {\n    //folder\n    //no update data\n}\nelse {\n    //codeable\n    var updateData = {};\n    value.updateData = updateData;\n    \n    if(oldElement.data !== undefined) {\n        //object data\n        updateData.data = oldElement.data;\n    }\n    else {\n        //object function\n        \n        if(oldElement.argList !== undefined) {\n            updateData.argList = oldElement.argList;\n        }\n        else {\n            updateData.argList = [];\n        }\n        \n        if(oldElement.functionBody !== undefined) {\n            updateData.functionBody = oldElement.functionBody;\n        }\n        else {\n            updateData.functionBody = \"\";\n        }\n        \n        if(oldElement.supplementalCode !== undefined) {\n            updateData.supplementalCode = oldElement.supplementalCode;\n        }\n        else {\n            updateData.supplementalCode = \"\";\n        }\n    }\n}\n\nreturn value;","supplementalCode":""}},"getCoreType":{"name":"getCoreType","type":"visicomp.core.FunctionTable","updateData":{"argList":["componentType"],"functionBody":"return typeMap[componentType];","supplementalCode":""}},"typeMap":{"name":"typeMap","type":"visicomp.core.JsonTable","updateData":{"data":{"visicomp.app.visiui.JsonTableComponent":"visicomp.core.JsonTable","visicomp.app.visiui.FunctionComponent":"visicomp.core.FunctionTable","visicomp.app.visiui.FolderComponent":"visicomp.core.Folder","visicomp.example.GoogleChartComponent":"visicomp.core.Control"}}},"getFolderContents":{"name":"getFolderContents","type":"visicomp.core.FunctionTable","updateData":{"argList":["oldFolderContents","convertFunction","parent"],"functionBody":"var newFolderContents = {};\n\nfor(var name in oldFolderContents) {\n    var oldElement = oldFolderContents[name];\n    var newElement = convertFunction(oldElement,parent);\n    \n    if(oldElement.children) {\n        newElement.children = getFolderContents(oldElement.children,convertFunction,newElement);\n    }\n    \n    newFolderContents[name] = newElement;\n}\n\nreturn newFolderContents;","supplementalCode":""}},"output":{"name":"output","type":"visicomp.core.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = {};\nvalue.name = input.name;\nvalue.fileType = input.fileType;\nvalue.jsLinks = input.jsLinks;\nvalue.cssLinks = input.cssLinks;\n\nvalue.workspace = {};\nvalue.workspace.name = input.name;\nvalue.workspace.fileType = \"visicomp workspace\";\nvalue.workspace.version = 0.1;\nvalue.workspace.data = {};\n\nvalue.workspace.data.name = input.name;\nvalue.workspace.data.type = \"visicomp.core.Folder\";\nvalue.workspace.data.children = workspaceData;\n\nvalue.components = componentData;\nreturn value;\n\n","supplementalCode":""}}}}},"components":{"input":{"key":"WorkspaceConvert:input","type":"visicomp.app.visiui.JsonTableComponent","coordInfo":{"x":26,"y":18,"width":500,"height":237},"windowState":0},"workspaceData":{"key":"WorkspaceConvert:workspaceData","type":"visicomp.app.visiui.JsonTableComponent","coordInfo":{"x":643,"y":0,"width":522,"height":259},"windowState":0},"componentData":{"key":"WorkspaceConvert:componentData","type":"visicomp.app.visiui.JsonTableComponent","coordInfo":{"x":615,"y":325,"width":822,"height":449},"windowState":0},"getComponentElement":{"key":"WorkspaceConvert:getComponentElement","type":"visicomp.app.visiui.FunctionComponent","coordInfo":{"x":801,"y":204,"width":442,"height":200},"windowState":0},"getWorkspaceElement":{"key":"WorkspaceConvert:getWorkspaceElement","type":"visicomp.app.visiui.FunctionComponent","coordInfo":{"x":799,"y":435,"width":535,"height":231},"windowState":0},"getCoreType":{"key":"WorkspaceConvert:getCoreType","type":"visicomp.app.visiui.FunctionComponent","coordInfo":{"x":1153,"y":288,"width":362,"height":200},"windowState":-1},"typeMap":{"key":"WorkspaceConvert:typeMap","type":"visicomp.app.visiui.JsonTableComponent","coordInfo":{"x":778,"y":545,"width":579,"height":170},"windowState":0},"getFolderContents":{"key":"WorkspaceConvert:getFolderContents","type":"visicomp.app.visiui.FunctionComponent","coordInfo":{"x":682,"y":488,"width":699,"height":272},"windowState":0},"output":{"key":"WorkspaceConvert:output","type":"visicomp.app.visiui.JsonTableComponent","coordInfo":{"x":18,"y":344,"width":553,"height":271},"windowState":0}}}