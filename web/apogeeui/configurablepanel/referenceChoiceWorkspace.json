{"fileType":"apogee app js workspace","version":"0.60","references":{"viewState":{"treeState":1,"lists":{"es module":{"treeState":0},"js link":{"treeState":0},"css link":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"ReferenceChoice","children":{"main":{"name":"main","type":"apogee.Folder","children":{"test":{"name":"test","type":"apogee.FunctionMember","updateData":{"argList":["admin"],"functionBody":"let updateMetaExpression = (meta,isSimpleExpression) => {\n    let newMeta = {};\n    Object.assign(newMeta,meta);\n    if(isSimpleExpression) {\n        newMeta.expression = \"simple\"\n    }\n    else {\n        delete newMeta.expression;\n    }\n    return newMeta;\n}\n\nlet onSubmit = (formValue,formObject) => {\n    let functionBody = apogeeui.getFormResultFunctionBody(formValue,formObject.getMeta());\n    admin.getCommandMessenger().dataCommand(\"formOutput\",functionBody);\n}\n\nreturn [\n    {\n        type: \"textField\",\n        label: \"URL: \",\n        size: 60,\n        key: \"url\",\n        selector: {\n            parentKey: \"urlChoice\",\n            actionFunction: (childElement,choiceElement) => {\n                let meta = childElement.getMeta();\n                if((choiceElement.getValue() == \"reference\")&&(meta.expression != \"simple\")) {\n                    let newMeta = updateMetaExpression(meta,true);\n                    childElement.meta = newMeta;\n                }\n                else if((choiceElement.getValue() == \"string\")&&(meta.expression)) {\n                    let newMeta = updateMetaExpression(meta,false);\n                    childElement.meta = newMeta;\n                }\n            }\n        },\n        meta: {\n            expression: \"simple\"\n        }\n    },\n    {\n        type: \"radioButtonGroup\",\n        label: \"URL Input Type: \",\n        entries: [[\"Reference\",\"reference\"],[\"String Value\",\"string\"]],\n        key: \"urlChoice\",\n        value: \"reference\"\n    },\n    {\n        type: \"submit\",\n        onSubmit: onSubmit\n    }\n]","supplementalCode":""}},"formOutput":{"name":"formOutput","type":"apogee.JsonMember","updateData":{"data":"let output = {};\noutput[\"url\"] = \"[1,2,3]\"\noutput[\"urlChoice\"] = \"string\"\nreturn output;"}}}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Reference/String Choice Example"}]},{"type":"paragraph","content":[{"type":"text","text":"This workspace demonstrates using a custom selector to modify the meta expression type for an input field."}]},{"type":"paragraph","content":[{"type":"text","text":"If we want to accomplish reference choices like this, which I think is a good idea, we should do a few things:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"Make this a predefined selector with a simple input, rather than requiring a custom selector"}]},{"type":"listItem","content":[{"type":"text","text":"We should make meta officially \"changeable\". Here we modified a private field. (And I wasn't sure it would even work, since I don't recall when meta is calculated.)"}]}]},{"type":"paragraph","content":[{"type":"text","text":"We might also want to think about other changes."}]},{"type":"heading2","content":[{"type":"text","text":"Test Form"}]},{"type":"paragraph","content":[{"type":"text","text":"Here is the test form. On submit we convert (or not) the value and send it to the form output."}]},{"type":"apogeeComponent","attrs":{"name":"test","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is the output form, showing the value with the selected url value as either a reference or a string."}]},{"type":"apogeeComponent","attrs":{"name":"formOutput","id":0,"state":""}}]}},"children":{"test":{"type":"apogeeapp.ActionFormCell","viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"formOutput":{"type":"apogeeapp.JsonCell","dataView":"Text Data","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true,"tabShowing":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}