{"fileType":"apogee app js workspace","version":"0.50","references":[],"workspace":{"fileType":"apogee workspace","version":0.2,"name":"WorkspaceUpdater","data":{"name":"Model","type":"apogee.Folder","children":{"inputFile":{"name":"inputFile","type":"apogee.JsonTable","updateData":{"data":{"fileType":"apogee app js workspace","version":"0.40","references":[],"workspace":{"fileType":"apogee workspace","version":0.2,"name":"Revenue Projection","data":{"name":"Model","type":"apogee.Folder","children":{"revenue_A":{"name":"revenue_A","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = [];\nvalue[0] = settings.initialRevenue;\nfor(var i = 0; i < settings.projectionCount; i++) {\n    value[i+1] = value[i] * (1 + settings.growthRate/100);\n}\nreturn value;\n\n","supplementalCode":"","description":""}},"settings":{"name":"settings","type":"apogee.JsonTable","updateData":{"data":{"initialYear":2015,"initialRevenue":1000000,"growthRate":3,"projectionCount":10},"description":""}},"revenue_B":{"name":"revenue_B","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = [];\nvalue[0] = createEntry(settings.initialYear,settings.initialRevenue);\nfor(var i = 0; i < settings.projectionCount; i++) {\n    value[i+1] = getNextEntry(value[i]);\n}\nreturn value;\n\n","supplementalCode":"function createEntry(year,revenue) {\n    entry = {};\n    entry.year = year;\n    entry.revenue = revenue;\n    return entry;\n}\n\nfunction getNextEntry(entry) {\n    var nextEntry = {};\n    nextEntry.year = entry.year + 1;\n    nextEntry.revenue = entry.revenue * (1 + settings.growthRate/100);\n    return nextEntry;\n}","description":""}},"totalRevenue":{"name":"totalRevenue","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = 0;\n\nfor(var i = 0; i < revenue_B.length; i++) {\n    value += revenue_B[i].revenue;\n}\nreturn value;\n\n","supplementalCode":"","description":""}},"revenueTable":{"name":"revenueTable","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = [];\n\n//add heading\nvalue.push([\"Year\",\"Revenue\"]);\n\n//add yearly values\nfor(var i = 0; i < revenue_B.length; i++) {\n    value.push([revenue_B[i].year,revenue_B[i].revenue]);\n}\n\n//add total\nvalue.push([\"Total\",totalRevenue]);\nreturn value;\n\n","supplementalCode":"","description":""}}}}},"components":{"type":"apogeeapp.app.FolderComponent","tabOpen":true,"treeState":1,"children":{"revenue_A":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":378,"height":356},"posInfo":{"x":159,"y":201},"state":0,"viewType":"Data"},"dataView":"Colorized"},"settings":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":161},"posInfo":{"x":265,"y":26},"state":0,"viewType":"Data"},"dataView":"Colorized"},"revenue_B":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":411,"height":347},"posInfo":{"x":45,"y":255},"state":0,"viewType":"Data"},"dataView":"Colorized"},"totalRevenue":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":221},"posInfo":{"x":677,"y":81},"state":0,"viewType":"Data"},"dataView":"Colorized"},"revenueTable":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":1082,"y":89},"state":0,"viewType":"Data"},"dataView":"Colorized"}}},"activeTabMember":"Model"},"description":""}},"sampleDocEntry":{"name":"sampleDocEntry","type":"apogee.JsonTable","updateData":{"data":{"type":"doc","content":[{"type":"apogeeComponent","attrs":{"name":"inputFile","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"This is a paragraph."}]}]},"description":""}},"outputFile":{"name":"outputFile","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"if(inputFile.length == 0) return \"\";\n\nlet output = apogee.util.jsonCopy(inputFile);\n\nif(inputFile.version != \"0.40\") throw new Error(\"Input should be version 0.40.\")\n\n//set new version\noutput.version = \"0.50\";\n\n//update the folder entries\nlet rootComponent = output.components;\n\n_processComponent(rootComponent);\n\nreturn output;","supplementalCode":"const APOGEE_COMPONENT_NODE = {\n\t\"type\": \"apogeeComponent\",\n\t\"attrs\": {\n\t\t\"name\": \"NAME_HERE\",\n\t\t\"id\": 0,\n\t\t\"state\": \"\"\n\t}\n}\n\t\t\nconst EMPTY_PARAGRAPH = {\n\t\"type\": \"paragraph\",\n\t\"content\": [\n\t\t{\n\t\t\t\"type\": \"text\",\n\t\t\t\"text\": \" \"\n\t\t}\n\t]\n}\n\nfunction _processComponent(component) {\n    //for now we only support folders as having doc elements\n    //we need to add folder functions.\n    if(component.type == \"apogeeapp.app.FolderComponent\") {\n        //create the doc entry\n        let doc = {};\n        component.data = {};\n        component.data.doc = doc;\n        doc.type = \"doc\";\n        doc.content = [];\n        //add the top empty paragraph\n        doc.content.push(_getEmptyParagraph());\n        \n        //traverse the children\n        for(var childName in component.children) {\n            let childComponent = component.children[childName];\n            \n            //add a child node and empty paragraph if this is not a folder (we need to cleaen this up...)\n            if(childComponent.type != \"apogee.Folder\") {\n                doc.content.push(_getApogeeComponent(childName));\n                doc.content.push(_getEmptyParagraph());\n            }\n            \n            //process this child component\n            _processComponent(childComponent)\n        }\n    }\n}\n\nfunction _getEmptyParagraph() {\n    return apogee.util.jsonCopy(EMPTY_PARAGRAPH);\n}\n\nfunction _getApogeeComponent(name) {\n    let node = apogee.util.jsonCopy(APOGEE_COMPONENT_NODE);\n    node.attrs.name = name;\n    return node;\n}\n","description":""}}}}},"components":{"type":"apogeeapp.app.FolderComponent","treeState":null,"data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Workspace Updater 0.4 to 0.5"}]},{"type":"paragraph","content":[{"type":"text","text":"The workspace will take a version 0.40 workspace file and convert it into a proper workspace 0.5 input file."}]},{"type":"heading2","content":[{"type":"text","text":"Input File"}]},{"type":"apogeeComponent","attrs":{"name":"inputFile","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Modifications"}]},{"type":"paragraph","content":[{"type":"text","text":"We have the following modifcations:"}]},{"type":"heading3","content":[{"type":"text","text":"File Version"}]},{"type":"paragraph","content":[{"type":"text","text":"The file version should be updated from \"0.40\" to \"0.50\"."}]},{"type":"heading3","content":[{"type":"text","text":"Doc Entry for Folders"}]},{"type":"paragraph","content":[{"type":"text","text":"Folders (soon to be called pages) have a \"doc\" entry for the \"data\" object in the for the folder component object. Below is a sample Doc entry including a single apogee component and a trivial paragraph."}]},{"type":"paragraph","content":[{"type":"text","text":"We will want to add an apogee component to the folder, along with a paragraph after each one, and a paragraph at the top. Note the paragraphs can not be empty, so they have some minor content."}]},{"type":"apogeeComponent","attrs":{"name":"sampleDocEntry","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Output Calculation"}]},{"type":"paragraph","content":[{"type":"text","text":"This entry will replace the version and insert the necessary components into each folder object."}]},{"type":"apogeeComponent","attrs":{"name":"outputFile","id":0,"state":""}}]},"selection":{"type":"text","anchor":1,"head":1}},"children":{"inputFile":{"type":"apogeeapp.app.JsonTableComponent","dataView":"Colorized"},"sampleDocEntry":{"type":"apogeeapp.app.JsonTableComponent","dataView":"Colorized"},"outputFile":{"type":"apogeeapp.app.JsonTableComponent","dataView":"Colorized"}}},"openTabs":["Model"],"activeTabMember":"Model"}