{"fileType":"apogee app js workspace","version":"0.60","references":{"refEntries":[{"url":"/applications/modules/chartjsmodule/src/ChartJSComponentModule.js","nickname":"ChartJSComponentModule.j","entryType":"es module"},{"url":"/applications/modules/csvmodule/src/CSVComponentModule.js","nickname":"CSVComponentModule.js","entryType":"es module"}],"viewState":{"treeState":1,"lists":{"es module":{"treeState":1},"js link":{"treeState":0},"css link":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"BisRevTest","children":{"main":{"name":"main","type":"apogee.Folder","children":{"dataUrl":{"name":"dataUrl","type":"apogee.JsonMember","updateData":{"data":"https://raw.githubusercontent.com/OpportunityInsights/EconomicTracker/main/data/Womply%20Revenue%20-%20National%20-%20Daily.csv"}},"nationalRevenueCsvText":{"name":"nationalRevenueCsvText","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return apogeeutil.textRequest(dataUrl); ","supplementalCode":""}},"nationalRevenueGraph":{"name":"nationalRevenueGraph","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"inputType\"] = \"form\"\noutput[\"formData\"]= {};\noutput[\"formData\"][\"xValuesType\"] = \"category\"\noutput[\"formData\"][\"xCategories\"] = dateLabels\noutput[\"formData\"][\"categoryDataSeries\"]= []\noutput[\"formData\"][\"categoryDataSeries\"][0]= {};\noutput[\"formData\"][\"categoryDataSeries\"][0][\"dataType\"] = \"structs\"\noutput[\"formData\"][\"categoryDataSeries\"][0][\"dataArray\"] = nationalRevenue.csv_data\noutput[\"formData\"][\"categoryDataSeries\"][0][\"yAccessor\"] = row => row[3] * 100\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"][\"label\"] = \"Total\"\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"][\"line\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"][\"line\"][\"selectColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"][\"line\"][\"borderWidth\"] = 3\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"][\"line\"][\"selectAreaColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"][\"point\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][0][\"options\"][\"point\"][\"selectColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][1]= {};\noutput[\"formData\"][\"categoryDataSeries\"][1][\"dataType\"] = \"structs\"\noutput[\"formData\"][\"categoryDataSeries\"][1][\"dataArray\"] = nationalRevenue.csv_data\noutput[\"formData\"][\"categoryDataSeries\"][1][\"yAccessor\"] = row => row[4] * 100\noutput[\"formData\"][\"categoryDataSeries\"][1][\"options\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][1][\"options\"][\"label\"] = \"High Income Areas\"\noutput[\"formData\"][\"categoryDataSeries\"][1][\"options\"][\"line\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][1][\"options\"][\"line\"][\"selectColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][1][\"options\"][\"line\"][\"selectAreaColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][1][\"options\"][\"point\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][1][\"options\"][\"point\"][\"selectColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][2]= {};\noutput[\"formData\"][\"categoryDataSeries\"][2][\"dataType\"] = \"structs\"\noutput[\"formData\"][\"categoryDataSeries\"][2][\"dataArray\"] = nationalRevenue.csv_data\noutput[\"formData\"][\"categoryDataSeries\"][2][\"yAccessor\"] = row => row[5] * 100\noutput[\"formData\"][\"categoryDataSeries\"][2][\"options\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][2][\"options\"][\"label\"] = \"Med Income Areas\"\noutput[\"formData\"][\"categoryDataSeries\"][2][\"options\"][\"line\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][2][\"options\"][\"line\"][\"selectColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][2][\"options\"][\"line\"][\"selectAreaColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][2][\"options\"][\"point\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][2][\"options\"][\"point\"][\"selectColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][3]= {};\noutput[\"formData\"][\"categoryDataSeries\"][3][\"dataType\"] = \"structs\"\noutput[\"formData\"][\"categoryDataSeries\"][3][\"dataArray\"] = nationalRevenue.csv_data\noutput[\"formData\"][\"categoryDataSeries\"][3][\"yAccessor\"] = row => row[6] * 100\noutput[\"formData\"][\"categoryDataSeries\"][3][\"options\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][3][\"options\"][\"label\"] = \"Low Income Areas\"\noutput[\"formData\"][\"categoryDataSeries\"][3][\"options\"][\"line\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][3][\"options\"][\"line\"][\"selectColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][3][\"options\"][\"line\"][\"selectAreaColor\"] = false\noutput[\"formData\"][\"categoryDataSeries\"][3][\"options\"][\"point\"]= {};\noutput[\"formData\"][\"categoryDataSeries\"][3][\"options\"][\"point\"][\"selectColor\"] = false\noutput[\"formData\"][\"options\"]= {};\noutput[\"formData\"][\"options\"][\"xValuesType\"] = \"category\"\noutput[\"formData\"][\"options\"][\"title\"]= {};\noutput[\"formData\"][\"options\"][\"title\"][\"display\"] = true\noutput[\"formData\"][\"options\"][\"title\"][\"text\"] = \"Small Business Revenue % Change from January\"\noutput[\"formData\"][\"options\"][\"title\"][\"fontSize\"] = 18\noutput[\"formData\"][\"options\"][\"title\"][\"selectColor\"] = false\noutput[\"formData\"][\"options\"][\"legend\"]= {};\noutput[\"formData\"][\"options\"][\"legend\"][\"display\"] = true\noutput[\"formData\"][\"options\"][\"line\"]= {};\noutput[\"formData\"][\"options\"][\"line\"][\"selectColor\"] = false\noutput[\"formData\"][\"options\"][\"line\"][\"borderWidth\"] = 1\noutput[\"formData\"][\"options\"][\"line\"][\"selectAreaColor\"] = false\noutput[\"formData\"][\"options\"][\"point\"]= {};\noutput[\"formData\"][\"options\"][\"point\"][\"showPoints\"] = false\noutput[\"formData\"][\"options\"][\"point\"][\"selectColor\"] = false\noutput[\"formData\"][\"options\"][\"yAxes\"]= {};\noutput[\"formData\"][\"options\"][\"yAxes\"][\"type\"] = \"linear\"\noutput[\"formData\"][\"options\"][\"yAxes\"][\"stacked\"] = false\noutput[\"storedFormValue\"] = {\"inputType\":\"form\",\"formData\":{\"xValuesType\":\"category\",\"xCategories\":\"dateLabels\",\"categoryDataSeries\":[{\"dataType\":\"structs\",\"dataArray\":\"nationalRevenue.csv_data\",\"yAccessor\":\"row => row[3] * 100\",\"options\":{\"label\":\"Total\",\"line\":{\"selectColor\":false,\"borderWidth\":3,\"fill\":\"default\",\"selectAreaColor\":false,\"doLineTension\":\"default\",\"spanGaps\":\"default\",\"stepped\":\"default\"},\"point\":{\"showPoints\":\"default\",\"pointStyle\":\"default\",\"radius\":\"default\",\"selectColor\":false,\"borderWidth\":\"default\"}}},{\"dataType\":\"structs\",\"dataArray\":\"nationalRevenue.csv_data\",\"yAccessor\":\"row => row[4] * 100\",\"options\":{\"label\":\"High Income Areas\",\"line\":{\"selectColor\":false,\"borderWidth\":\"default\",\"fill\":\"default\",\"selectAreaColor\":false,\"doLineTension\":\"default\",\"spanGaps\":\"default\",\"stepped\":\"default\"},\"point\":{\"showPoints\":\"default\",\"pointStyle\":\"default\",\"radius\":\"default\",\"selectColor\":false,\"borderWidth\":\"default\"}}},{\"dataType\":\"structs\",\"dataArray\":\"nationalRevenue.csv_data\",\"yAccessor\":\"row => row[5] * 100\",\"options\":{\"label\":\"Med Income Areas\",\"line\":{\"selectColor\":false,\"borderWidth\":\"default\",\"fill\":\"default\",\"selectAreaColor\":false,\"doLineTension\":\"default\",\"spanGaps\":\"default\",\"stepped\":\"default\"},\"point\":{\"showPoints\":\"default\",\"pointStyle\":\"default\",\"radius\":\"default\",\"selectColor\":false,\"borderWidth\":\"default\"}}},{\"dataType\":\"structs\",\"dataArray\":\"nationalRevenue.csv_data\",\"yAccessor\":\"row => row[6] * 100\",\"options\":{\"label\":\"Low Income Areas\",\"line\":{\"selectColor\":false,\"borderWidth\":\"default\",\"fill\":\"default\",\"selectAreaColor\":false,\"doLineTension\":\"default\",\"spanGaps\":\"default\",\"stepped\":\"default\"},\"point\":{\"showPoints\":\"default\",\"pointStyle\":\"default\",\"radius\":\"default\",\"selectColor\":false,\"borderWidth\":\"default\"}}}],\"options\":{\"xValuesType\":\"category\",\"title\":{\"display\":true,\"text\":\"Small Business Revenue % Change from January\",\"fontSize\":18,\"selectColor\":false},\"legend\":{\"display\":true,\"position\":\"default\"},\"line\":{\"selectColor\":false,\"borderWidth\":1,\"fill\":\"default\",\"selectAreaColor\":false,\"doLineTension\":\"default\",\"spanGaps\":\"default\",\"stepped\":\"default\"},\"point\":{\"showPoints\":false,\"pointStyle\":\"default\",\"radius\":\"default\",\"selectColor\":false,\"borderWidth\":\"default\"},\"yAxes\":{\"type\":\"linear\",\"stacked\":false}}}}\nreturn output;","supplementalCode":""}},"test":{"name":"test","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return nationalRevenue;","supplementalCode":""}},"dateLabels":{"name":"dateLabels","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return nationalRevenue.csv_data.map( row => `${row[1]}/${row[2]}/${row[0]}`);","supplementalCode":""}},"nationalRevenue":{"name":"nationalRevenue","type":"apogee.Folder","children":{"csv_data":{"name":"csv_data","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"\n    if(csv_input.input) {\n        let options = {};\n        options.dynamicTyping = csv_input.dynamicTyping;\n        options.skipEmptyLines = csv_input.skipEmptyLines;\n        let result = __papaparse.parse(csv_input.input,options);\n        if(result.errors.length == 0) {\n            let headers = [];\n            let body = [];\n            if((result.data)&&(result.data.length > 0)) {                \n                result.data.forEach( (row,index) => {\n                    if(index == 0) {\n                        headers.push(row);\n                    }\n                    else {\n                        body.push(row);\n                    }\n                });\n\n                \n            }\n\n            apogeeMessenger.dataUpdate(\"csv_header\",headers);\n            return body;\n            \n        }\n        else {\n            let errorMsg = \"Parsing Error: \" + result.errors.join(\";\");\n            throw new Error(errorMsg);\n        }\n    }\n    else {\n        apogeeMessenger.dataUpdate(\"csv_header\",[[]]);\n        return [[]];\n    }\n"}},"csv_header":{"name":"csv_header","type":"apogee.JsonMember","updateData":{"data":[["year","month","day","revenue_all","revenue_inchigh","revenue_inclow","revenue_incmiddle","revenue_ss40","revenue_ss65","revenue_ss70"]]}},"csv_input":{"name":"csv_input","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"input\"] = nationalRevenueCsvText\noutput[\"dynamicTyping\"] = false\noutput[\"skipEmptyLines\"] = false\noutput[\"storedFormValue\"] = {\"input\":\"nationalRevenueCsvText\",\"dynamicTyping\":false,\"skipEmptyLines\":false}\nreturn output;","supplementalCode":""}}}}}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Test Chart Workspace"}]},{"type":"paragraph","content":[{"type":"text","text":"This is a test chart workspace. I will download some CSV data and graphit."}]},{"type":"heading2","content":[{"type":"text","text":"Data"}]},{"type":"paragraph","content":[{"type":"text","text":"Here is the url for data from TrackTheRecovery.com."}]},{"type":"apogeeComponent","attrs":{"name":"dataUrl","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is the downloaded data."}]},{"type":"apogeeComponent","attrs":{"name":"nationalRevenueCsvText","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here we convert to JSON"}]},{"type":"apogeeComponent","attrs":{"name":"nationalRevenue","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"dateLabels","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"test","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Graph"}]},{"type":"paragraph","content":[{"type":"text","text":"Here we graph the data."}]},{"type":"apogeeComponent","attrs":{"name":"nationalRevenueGraph","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Usage Notes from this Test"}]},{"type":"paragraph","content":[{"type":"text","text":"These are some notes regarding the experience making this workspace."}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"It was a little bit of a pain entering the urls. It would be nice to have a place to lookup links and automatically include them."}]},{"type":"listItem","content":[{"type":"text","text":"When making the chart and the csv, initially they were empty but they both were still big. It would be better if they were not so big then."}]},{"type":"listItem","content":[{"type":"text","text":"I forgot to read the csv data properly as a sub element of the cell."}]},{"type":"listItem","content":[{"type":"text","text":"I had to strip out the body data from the header. I should probably do this automatically and give the user access to both."}]},{"type":"listItem","content":[{"type":"text","text":"I mistyped the label cell name and it was ignored. This will be confusing to people if they hit this error. I might want to try to detect this error."}]}]},{"type":"paragraph"},{"type":"paragraph"}]}},"children":{"dataUrl":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"nationalRevenueCsvText":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"height":280,"isViewActive":false},"Formula":{"height":7000,"isViewActive":true},"Private":{"isViewActive":false}}}}},"nationalRevenueGraph":{"type":"apogeeapp.ChartJSCell","chartType":"line","viewState":{"childDisplayState":{"views":{"Chart":{"isViewActive":true},"Input":{"isViewActive":true}}}}},"test":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"dateLabels":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"nationalRevenue":{"type":"apogeeapp.CSVCell","viewState":{"childDisplayState":{"views":{"Header":{"height":55,"isViewActive":true},"Data":{"height":300,"isViewActive":true},"Input":{"isViewActive":true}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true,"tabShowing":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}