<!DOCTYPE html>
<html>
    <head>
        <title>Hax Quickstart Part 2</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="/web/base.css">
        <link rel="stylesheet" href="/web/tutorials/tutorial.css">
    </head>
    <body>
        <!-- header -->
        <a class="headerLink" href="/web/home.html"><img class="headerLogo" src="/web/logo51.png"></a>
        <a class="headerLink" href="/web/home.html">Home</a>
        <a class="headerLink" href="/hax.html">Application</a>
        <a class="headerLink" href="/web/tutorials/tutorials.html">Tutorials</a>
        <a class="headerLink" href="/web/reference/reference.html">Reference</a>
        <a class="headerLink" href="/web/downloads/downloads.html">Downloads</a>
        <a class="headerLink" href="/web/tools/fileConvert.html">Tools</a>
        <a class="headerLink" href="/web/about.html">About</a>
        <hr class="headerBreak">
        <!-- end header -->
        <h2>Quickstart Part 2</h2>
        <p>This is a continuation of the Quickstart. It adds some more detail about data tables and introduces the grid table.</p> 
        <div>
            <ol class="numericList">
                <li>We start with the project you just finished in the Quickstart part 1. Alternatively you can
                    close you workspace and open the following one. To do this, select "Open" from the "Workspace" 
                    menu and paste in the following data:
                    <div><textarea class="codeText" readonly rows="6">
{"name":"workspace","fileType":"hax workspace","jsLinks":[],"cssLinks":[],"workspace":{"name":"workspace","fileType":"hax workspace","version":0.1,"data":{"name":"workspace","type":"hax.core.Folder","children":{"settings":{"name":"settings","type":"hax.core.JsonTable","updateData":{"data":{"initialYear":2015,"initialRevenue":1000000,"growthRate":3,"projectionCount":10}}},"revenueList":{"name":"revenueList","type":"hax.core.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvalue = [];\r\nvalue[0] = settings.initialRevenue;\r\nfor(var i = 1; i < settings.projectionCount; i++) {\r\n    value[i] = value[i-1] * (1 + settings.growthRate/100);\r\n}\r\n       \nreturn value;\n\n","supplementalCode":""}}}}},"components":{"settings":{"key":"workspace:settings","type":"hax.app.visiui.JsonTableComponent","coordInfo":{"x":15,"y":19},"windowState":0},"revenueList":{"key":"workspace:revenueList","type":"hax.app.visiui.JsonTableComponent","coordInfo":{"x":386,"y":72},"windowState":0}}}
                          </textarea>
                    </div>            
                </li>
                <li>Go to the "Formula" for the table "revenueList" and update the code as follows:
                    <div><textarea class="codeText" readonly rows="6">
value = [];
value[0] = getEntry(settings.initialYear,settings.initialRevenue);
for(var i = 1; i < settings.projectionCount; i++) {
    value[i] = getNextEntry(value[i-1]);
}
                          </textarea>
                    </div>
                    <div><img src="newCode.png"/></div>
                </li>
                <li>Press save. There is an error because we have not defined the function "getEntry".
                    <div><img src="newCodeError.png"/></div>                      
                </li>
                <li>From the dropdown select "Private". Add the following code there.
                    <p class="sideNote">The code in the private section is accessible to the formula, and nowhere else.</p>
                    <div><textarea class="codeText" readonly rows="13">
function getEntry(year,revenue) {
    var entry = {};
    entry.year = year;
    entry.revenue = revenue;
    return entry;
}

function getNextEntry(previousEntry) {
    var newYear = previousEntry.year + 1;
    var newRevenue = previousEntry.revenue * (1 + settings.growthRate/100);
    return getEntry(newYear,newRevenue);
}
                          </textarea>
                    </div>
                    <div><img src="privateCode.png"/></div>
                </li>
                <li>Save the private code and return to the "Text" view. Now we have an array of compound entries.
                    <div><img src="newRevenueList.png"/></div>
                </li>
                <li>Create a Grid Table, called "revenueGrid". 
                    <div><img src="addGridTable.png"/></div>               
                </li>                
                <li>Set the formula for the grid to be the following code.
                    <div><textarea class="codeText" readonly rows="7">
value = [];
value.push(getRow("Year","Revenue"));
for(var i = 0; i < revenueList.length; i++) {
    var entry = revenueList[i];
    value.push(getRow(entry.year,entry.revenue));
}
                    </textarea></div>
                    <div>
                        <img src="revenueGridFormula.png"/>
                    </div>
                </li>
                <li>Set the private code for the grid to be the following code.
                    <div><textarea class="codeText" readonly rows="4">
function getRow(first,second) {
    return [first,second];
}
                    </textarea></div>
                    <p class="sideNote">The error below is the error we get before we save the private code defining the function "getRow".</p>
                    <div>
                        <img src="revenueGridPrivate.png"/>
                    </div>
                </li> 
                <li>Saving and returning to the "Text" view should give the following result.
                    <div><img src="revenueGridResult.png"/></div>                      
                </li>
                <li>Add another Data Table, with the name "revenueGridAsJSON". Set the following formula:
                    <p class="sideNote">Here we are assigning the value of revenueGridAsJSON table to be the value of the revenueGrid.</p>
                    <div><textarea class="codeText" readonly rows="2">
value = revenueGrid;
                    </textarea></div>
                    <div><img src="gridToJsonFormula.png"/></div>                      
                </li>
                <li>Returning to the "Text" view gives the following result. 
                    <p class="sideNote">The Grid Table has a JSON object for data, just like the Data Table.
                    The Grid Table JSON is an array rows, with each row being an array of values.</p>
                    <div><img src="gridToJsonResult.png"/></div>                      
                </li>
                <li>Now try modifying the revenueGridAsJSON formula as follows:
                    <p class="sideNote">We are assigning the revenueGrid value to revenueGridAsJSON and then modifying it.</p>
                    <div><textarea class="codeText" readonly rows="3">
value = revenueGrid;
value[0].push("title for another column");
                    </textarea></div>
                    <div><img src="gridToJsonWithEdit.png"/></div>                      
                </li>
                <li>When we save, we get an error. You can't modify a table copied like this.
                    <p class="sideNote">We set revenueGridAsJSON to be the <b>same object</b> as revenueGrid. By modifying
                    revenueGridAsJSON we are also modifying revenueGrid. This is illegal. You can not modify the value
                    of one table from another table's formula. The value read from a table is <b>immutable</b>.</p>
                    <div><img src="gridToJsonEditError.png"/></div>                      
                </li>
                <li>Now modify the revenueGridAsJSON formula as follows:
                    <p class="sideNote">Here we are making a copy of the revenueGrid value. We can edit this copy.</p>
                    <div><textarea class="codeText" readonly rows="3">
value = hax.util.deepJSONCopy(revenueGrid);
value[0].push("title for another column");
                    </textarea></div>
                    <div><img src="gridToJsonEditNoError.png"/></div>                      
                </li>
                <li>The result in the "Text" view shows the edited data.
                    <div><img src="gridToJsonEditResult.png"/></div>                      
                </li>
            </ol>
        </div>
    </body>
</html>
