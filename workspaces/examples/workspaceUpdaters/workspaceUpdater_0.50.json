{"fileType":"apogee app js workspace","version":"0.60","references":{"viewState":{"treeState":-1,"lists":{"es module":{"treeState":0},"js link":{"treeState":0},"css link":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"WorkspaceUpdater_0.50","children":{"Model":{"name":"Model","type":"apogee.Folder","children":{"inputFile":{"name":"inputFile","type":"apogee.JsonMember","updateData":{"data":""}},"reformatFile":{"name":"reformatFile","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"if(inputFile.length == 0) return \"\";\n\nlet output = apogeeutil.jsonCopy(inputFile);\n\nif(inputFile.version != \"0.40\") throw new Error(\"Input should be version 0.40.\")\n\n//set new version\noutput.version = \"0.50\";\n\n//update the folder entries\nlet rootComponent = output.components;\n\n_processComponent(rootComponent);\n\nreturn output;","supplementalCode":"const APOGEE_COMPONENT_NODE = {\n\t\"type\": \"apogeeComponent\",\n\t\"attrs\": {\n\t\t\"name\": \"NAME_HERE\",\n\t\t\"id\": 0,\n\t\t\"state\": \"\"\n\t}\n}\n\t\t\nconst EMPTY_PARAGRAPH = {\n\t\"type\": \"paragraph\",\n\t\"content\": [\n\t\t{\n\t\t\t\"type\": \"text\",\n\t\t\t\"text\": \" \"\n\t\t}\n\t]\n}\n\nfunction _processComponent(component) {\n    //for now we only support folders as having doc elements\n    //we need to add folder functions.\n    if(component.type == \"apogeeapp.app.FolderComponent\") {\n        //create the doc entry\n        let doc = {};\n        component.data = {};\n        component.data.doc = doc;\n        doc.type = \"doc\";\n        doc.content = [];\n        //add the top empty paragraph\n        doc.content.push(_getEmptyParagraph());\n        \n        //traverse the children\n        for(var childName in component.children) {\n            let childComponent = component.children[childName];\n            \n            //add a child node and empty paragraph if this is not a folder (we need to cleaen this up...)\n            if(childComponent.type != \"apogee.Folder\") {\n                doc.content.push(_getApogeeComponent(childName));\n                doc.content.push(_getEmptyParagraph());\n            }\n            \n            //process this child component\n            _processComponent(childComponent)\n        }\n    }\n}\n\nfunction _getEmptyParagraph() {\n    return apogeeutil.jsonCopy(EMPTY_PARAGRAPH);\n}\n\nfunction _getApogeeComponent(name) {\n    let node = apogeeutil.jsonCopy(APOGEE_COMPONENT_NODE);\n    node.attrs.name = name;\n    return node;\n}\n"}},"libNameFixed":{"name":"libNameFixed","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let textData = JSON.stringify(reformatFile);\n\nnameChanges.forEach( row => {\n    textData = textData.replace(new RegExp(row[0],\"g\"), row[1]);\n})\n\nreturn JSON.parse(textData);","supplementalCode":""}},"nameChanges":{"name":"nameChanges","type":"apogee.JsonMember","updateData":{"data":[["apogee.util","apogeeutil"],["apogee.net","apogeeutil"]]}},"outputFile":{"name":"outputFile","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return libNameFixed;","supplementalCode":""}}}}}},"components":{"Model":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Workspace Updater 0.4 to 0.5"}]},{"type":"paragraph","content":[{"type":"text","text":"The workspace will take a version 0.40 workspace file and convert it into a proper workspace 0.5 input file."}]},{"type":"heading2","content":[{"type":"text","text":"Input File"}]},{"type":"apogeeComponent","attrs":{"name":"inputFile","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Output File"}]},{"type":"apogeeComponent","attrs":{"name":"outputFile","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Modifications"}]},{"type":"paragraph","content":[{"type":"text","text":"We have the following modifcations:"}]},{"type":"heading3","content":[{"type":"text","text":"File Version"}]},{"type":"paragraph","content":[{"type":"text","text":"The file version should be updated from \"0.40\" to \"0.50\"."}]},{"type":"heading3","content":[{"type":"text","text":"Doc Entry for Folders"}]},{"type":"paragraph","content":[{"type":"text","text":"Folders (soon to be called pages) have a \"doc\" entry for the \"data\" object in the for the folder component object. Below is a sample Doc entry including a single apogee component and a trivial paragraph."}]},{"type":"paragraph","content":[{"type":"text","text":"We will want to add an apogee component to the folder, along with a paragraph after each one, and a paragraph at the top. Note the paragraphs can not be empty, so they have some minor content."}]},{"type":"heading3","content":[{"type":"text","text":"Library Name Modification"}]},{"type":"paragraph","content":[{"type":"text","text":"apogee.util => apogeeutil"}]},{"type":"paragraph","content":[{"type":"text","text":"apogee.net => apogeeutil"}]},{"type":"heading2","content":[{"type":"text","text":"Format Change"}]},{"type":"paragraph","content":[{"type":"text","text":"This entry will replace the version and insert the necessary components into each folder object."}]},{"type":"apogeeComponent","attrs":{"name":"reformatFile","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Lib Name Substitution"}]},{"type":"paragraph","content":[{"type":"text","text":"Here we fix for the name change of the apogee util and apogee net libraries."}]},{"type":"apogeeComponent","attrs":{"name":"libNameFixed","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Name Substitution Table"}]},{"type":"apogeeComponent","attrs":{"name":"nameChanges","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"s"}]}]}},"children":{"inputFile":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"reformatFile":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false,"height":7000},"Private":{"isViewActive":false}}}}},"libNameFixed":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"nameChanges":{"type":"apogeeapp.JsonCell","dataView":"Grid","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":80},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"outputFile":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":-1,"tabOpened":true,"tabShowing":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}