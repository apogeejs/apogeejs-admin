{"fileType":"apogee app js workspace","version":"0.40","references":[],"workspace":{"fileType":"apogee workspace","version":0.2,"name":"presetDownload","data":{"name":"Model","type":"apogee.Folder","children":{"factoryKey":{"name":"factoryKey","type":"apogee.JsonTable","updateData":{"data":"yfZkszbELEy6lxz1sSeUZscJlC41hL","description":""}},"urlList":{"name":"urlList","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var value;\noutputList = [];\n\nfor(var cidString in masterOverrides) {\n    //get valid override entry\n    var masterEntry = masterOverrides[cidString];\n    \n    if(masterEntry.success) {\n        var masterOverride = masterEntry.data;\n        \n        //get urls and types\n        loadList(masterOverride,\"themeMapOverrides\",outputList);\n        loadList(masterOverride,\"presetOverrides\",outputList);\n        loadList(masterOverride,\"stringsOverrides\",outputList);\n        loadList(masterOverride,\"inputColorOverrides\",outputList);\n        \n        //do theme later\n        loadThemeOverrides(masterOverride,outputList);\n    }\n}\n\nvalue = outputList;\nreturn value;\n\n","supplementalCode":" function loadList(entry,listName,resultList) {\n    var list = entry[listName];\n    if((list)&&(list.length > 0)) {\n        for(var i = 0; i < list.length; i++) {\n            resultList.push(getUrlEntry(entry.cid,listName,list[i]));\n        }\n    }\n}\n\nfunction getUrlEntry(cid,listName,overrideEntry) {\n    var urlEntry = {};\n    urlEntry.cid = cid;\n    urlEntry.type = listName;\n    urlEntry.url = overrideEntry;\n    return urlEntry;\n}\n\nfunction loadThemeOverrides(entry,resultList) {\n    var themeMap = entry.themeOverrides;\n    if(themeMap) {\n        for(var themeName in themeMap) {\n            var list = themeMap[themeName];\n            if((list)&&(list.length > 0)) {\n                for(var i = 0; i < list.length; i++) {\n                    resultList.push(getThemeUrlEntry(entry.cid,themeName,list[i]));\n                }\n            }\n        }\n    }\n}\n\nfunction getThemeUrlEntry(cid,themeName,overrideEntry) {\n    var urlEntry = {};\n    urlEntry.cid = cid;\n    urlEntry.type = \"themeOverrides\";\n    urlEntry.theme = themeName;\n    urlEntry.url = overrideEntry;\n    return urlEntry;\n}\n\n","description":""}},"overrides":{"name":"overrides","type":"apogee.JsonTable","updateData":{"argList":[],"functionBody":"var value;\nvar workingOverrides = {};\n\nvar listInfo = {};\nlistInfo.index = 0;\nlistInfo.outputData = workingOverrides;\nlistInfo.inputList = urlList;\n\nreturn getUrlList(listInfo);\nreturn value;\n\n","supplementalCode":"//this gets a list of urls based on a list info object\nvar getUrlList = function(listInfo) {\n    \n    var urlEntry = listInfo.inputList[listInfo.index];\n    if(listInfo.outputData[urlEntry.url] === undefined) {\n        //download\n        var url = urlEntry.url + \"?key=\" + factoryKey;\n        console.log(\"Requesting \" + urlEntry.cid + \": \" + url);\n        \n        var onDownload = function(json) {\n            return downloadSuccess(listInfo,urlEntry,json);\n        }\n        var onError = function(err) {\n            return downloadError(listInfo,urlEntry,err);\n        }\n        \n        return .jsonRequest(url).then(onDownload).catch(onError);\n    }\n    else {\n        //we alredy have it - go to next\n        return getNext(listInfo);\n    }\n}\n\n//called when a url is successfully loaded\nvar downloadSuccess = function(listInfo,urlEntry,json) {\n    \n    var resultEntry = {};\n    resultEntry.success = true;\n    resultEntry.type = urlEntry.type;\n    resultEntry.data = json;\n    \n    listInfo.outputData[urlEntry.url] = resultEntry;\n    \n    return getNext(listInfo);\n}\n\n//called whena url fails\nvar downloadError = function(listInfo,urlEntry,errorMsg) {\n    \n    var resultEntry = {};\n    resultEntry.success = false;\n    resultEntry.data = errorMsg;\n    \n    listInfo.outputData[urlEntry.url] = resultEntry;\n    \n    return getNext(listInfo);\n}\n\n//this iterates the list and calls the next, if applicable\nvar getNext = function(listInfo) {\n    listInfo.index++;\n    if(listInfo.index < listInfo.inputList.length) {\n        return getUrlList(listInfo);\n    }\n    else {\n        return listInfo.outputData\n    }\n}","description":""}},"masterOverrides":{"name":"masterOverrides","type":"apogee.JsonTable","updateData":{"data":{"1":{"success":true,"data":{"none":true,"cid":1}},"2":{"success":true,"data":{"none":true,"cid":2}},"3":{"success":true,"data":{"themeMapOverrides":[],"cid":3,"presetOverrides":["http://factory-mfs.micello.com/ms/v1/mfile/map/3/overrides/presets"],"stringsOverrides":[]}},"4":{"success":true,"data":{"none":true,"cid":4}},"5":{"success":true,"data":{"none":true,"cid":5}},"6":{"success":true,"data":{"themeMapOverrides":[],"cid":6,"presetOverrides":["http://factory-mfs.micello.com/ms/v1/mfile/map/6/overrides/presets"],"stringsOverrides":[]}},"7":{"success":true,"data":{"themeMapOverrides":[],"cid":7,"presetOverrides":["http://factory-mfs.micello.com/ms/v1/mfile/map/7/overrides/presets"],"stringsOverrides":[]}},"8":{"success":true,"data":{"none":true,"cid":8}},"9":{"success":true,"data":{"themeMapOverrides":[],"cid":9,"presetOverrides":["http://factory-mfs.micello.com/ms/v1/mfile/map/9/overrides/presets"],"stringsOverrides":[]}},"10":{"success":true,"data":{"none":true,"cid":10}}},"description":""}}}}},"components":{"type":"apogeeapp.app.FolderComponent","tabOpen":true,"treeState":1,"children":{"factoryKey":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":25,"y":25},"state":0,"viewType":"Data"},"dataView":"Colorized"},"urlList":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":305,"y":395},"state":0,"viewType":"Data"},"dataView":"Colorized"},"overrides":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":585,"height":571},"posInfo":{"x":554,"y":95},"state":0,"viewType":"Private"},"dataView":"Colorized"},"masterOverrides":{"type":"apogeeapp.app.JsonTableComponent","windowState":{"sizeInfo":{"width":300,"height":300},"posInfo":{"x":53,"y":502},"state":0,"viewType":"Data"},"dataView":"Colorized"}}},"activeTabMember":"Model"}