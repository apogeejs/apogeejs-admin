{"fileType":"apogee app js workspace","version":"0.60","references":{"viewState":{"treeState":1,"lists":{"es module":{"treeState":0},"js link":{"treeState":0},"css link":{"treeState":0}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"OneDriveCodeFlow","children":{"main":{"name":"main","type":"apogee.Folder","children":{"oneDriveAppInfo":{"name":"oneDriveAppInfo","type":"apogee.JsonMember","updateData":{"data":{"authServiceUri":"https://login.microsoftonline.com/common/oauth2/v2.0/authorize","clientId":"d87a2f91-7064-41d0-85b2-3e0775068ac2","clientSecret":"DELETED!!!","redirectUri":"http://localhost:8888/dev/OneDrive/oneDriveAuthCallback.html","scopes":"wl.offline_access user.read"}}},"loginForm":{"name":"loginForm","type":"apogee.FunctionMember","updateData":{"argList":["admin"],"functionBody":"//create a external callback to receive the response\n__globals__.oneDriveAuthCallback = (childWindow) => {\n    if(childWindow) {\n        let callbackInfo = {};\n        callbackInfo.hash = childWindow.location.hash;\n        callbackInfo.search = childWindow.location.search;\n        admin.getCommandMessenger().dataCommand(\"oneDriveCallbackData\",callbackInfo);\n        childWindow.close();\n    }\n} \n\nlet onLogin = () => {\n    //should we verify requesting page is https/file/localhost?\n    let url = `https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=${oneDriveAppInfo.clientId}&redirect_uri=${oneDriveAppInfo.redirectUri}&scope=${oneDriveAppInfo.scopes}&response_type=code`;\n    utils.openPopup(url);\n}\n\nlet onLogout = () => {\n    //should we verify requesting page is https/file/localhost?\n    //let url = `https://login.live.com/oauth20_logout.srf?client_id=${oneDriveAppInfo.clientId}&redirect_uri=${oneDriveAppInfo.redirectUri}`;\n    let url = \"http://localhost:8888/dev/OneDrive/oneDriveAuthCallback.html\"\n    utils.openPopup(url);\n}\n\nreturn [\n    {\n        type: \"submit\",\n        onSubmit: onLogin,\n        onCancel: onLogout,\n        submitLabel: \"Login\",\n        cancelLabel: \"Logout\"\n    }    \n]"}},"baseUrl":{"name":"baseUrl","type":"apogee.JsonMember","updateData":{"data":"https://graph.microsoft.com/v1.0/me/"}},"driveResponse":{"name":"driveResponse","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let options = {\n    header: { \n        \"Authorization\": \"Bearer \" + token,\n        \"Accept\": \"application/json;odata.metadata=none\"\n    }\n};\n\n\nlet folderPathPart;\nif(folderPath === \"\") {\n    folderPathPart = \"\";\n}\nelse {\n    folderPathPart = \":\" + folderPath + \":\"; \n}\n\nlet requestUrl = driveBaseUrl + folderPathPart + \"?expand=thumbnails,children(expand=thumbnails(select=large))\";\nreturn apogeeutil.jsonRequest(requestUrl,options);","supplementalCode":""}},"folderPath":{"name":"folderPath","type":"apogee.JsonMember","updateData":{"data":"/test"}},"driveBaseUrl":{"name":"driveBaseUrl","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return baseUrl + \"drive/root\"","supplementalCode":""}},"parentInfo":{"name":"parentInfo","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let parentEntry;\nif(driveResponse.parentReference) {\n    let parentPath;\n    let parentName;\n    if(driveResponse.parentReference.path) {\n        parentPath = driveResponse.parentReference.path.substring(\"/drive/root:\".length);\n        if(parentPath === \"\") {\n            parentPath = \"\"\n            parentName = \"/\";\n        }\n        else {\n            parentName = driveResponse.parentReference.name;\n        }\n        \n        parentEntry = {\n           name: parentName,\n           path: parentPath,\n           type: \"folder\"\n        }\n    }\n}\n\nif(!parentEntry) parentEntry = null;\n\nreturn parentEntry;","supplementalCode":""}},"childEntries":{"name":"childEntries","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"\nlet children = [];\n\nif(driveResponse.folder) {\n    driveResponse.children.forEach( childEntry => {\n        let outEntry = {};\n        outEntry.name = childEntry.name;\n        if(childEntry.file) {\n            outEntry.url = childEntry[\"@microsoft.graph.downloadUrl\"];\n            outEntry.type = childEntry.file.mimeType;\n        }\n        if(childEntry.folder) {\n            outEntry.path = folderPath + \"/\" + outEntry.name;\n            outEntry.type = \"folder\";\n        }\n        let label = outEntry.name + \" - \" + outEntry.type;\n        children.push([label,outEntry]);\n    });\n}\n\nreturn children;","supplementalCode":""}},"fileName":{"name":"fileName","type":"apogee.JsonMember","updateData":{"data":"test.json"}},"fileContent":{"name":"fileContent","type":"apogee.JsonMember","updateData":{"data":[1,2,3]}},"openForm":{"name":"openForm","type":"apogee.FunctionMember","updateData":{"argList":["admin"],"functionBody":"\n\nlet onOpen = formValue => {\n    \n    let selected = formValue.selected;\n    \n    if(selected.type == \"folder\") {\n        admin.getCommandMessenger().dataCommand(\"folderPath\",selected.path);\n    }\n    else {\n        let contentPromise\n        if(selected.type == \"application/json\") {\n            contentPromise = apogeeutil.jsonRequest(selected.url);\n        }\n        else if(selected.type == \"text/plain\") {\n            contentPromise = apogeeutil.textRequest(selected.url);\n        }\n        else {\n            alert(\"Only files of type json or plain text can be opened\");\n            return;\n        }\n        \n        admin.getCommandMessenger().compoundDataCommand([[\"fileName\",selected.name],[\"fileContent\",contentPromise]]);\n    }\n}\n\nlet allEntries;\nif(parentInfo) {\n    parentEntry = [\"Parent Folder\",parentInfo];\n    allEntries = [parentEntry].concat(childEntries);\n}\nelse {\n    allEntries = childEntries;\n}\n\nreturn [ \n    {\n        type: \"heading\",\n        text: \"File Path: \" + folderPath,\n        key: \"filePath\"\n    },\n    {\n        type: \"dropdown\",\n        label: \"Children: \",\n        entries: allEntries,\n        key: \"selected\",\n    },\n    {\n        type: \"submit\",\n        onSubmit: onOpen,\n        submitLabel: \"Open Selected\"\n    }\n]","supplementalCode":""}},"oneDriveCallbackData":{"name":"oneDriveCallbackData","type":"apogee.JsonMember","updateData":{"data":{"hash":"","search":"?code=M.R3_BAY.53a904cb-2eb8-d2ef-ffc4-511cd6cde2fa"}}},"authCodeData":{"name":"authCodeData","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"if(oneDriveCallbackData.search) {\n    let paramArray = oneDriveCallbackData.search.substring(1).split(\"&\").map(entry => entry.split(\"=\"));\n    let data = {};\n    paramArray.forEach( pair => data[pair[0]] = decodeURIComponent(pair[1]))\n    return data;\n}\nelse {\n    return null;\n}","supplementalCode":""}},"authTokenForm":{"name":"authTokenForm","type":"apogee.FunctionMember","updateData":{"argList":["admin"],"functionBody":"let onLoadToken = () => {\n    //should we verify requesting page is https/file/localhost?\n    let url = \"https://login.microsoftonline.com/common/oauth2/v2.0/token\";\n    let options = {\n        method: \"POST\",\n        header: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        body: `client_id=${oneDriveAppInfo.clientId}&redirect_uri=${oneDriveAppInfo.redirectUri}&client_secret=${oneDriveAppInfo.clientSecret}&code=${authCodeData.code}&&scope=wl.offline_access&grant_type=authorization_code`\n    }\n    \n    let tokenPromise = apogeeutil.jsonRequest(url,options);\n    admin.getCommandMessenger().dataCommand(\"authTokenResponse\",tokenPromise);\n}\n\n\nreturn [\n    {\n        type: \"submit\",\n        onSubmit: onLoadToken,\n        submitLabel: \"Load Token\",\n    }    \n]","supplementalCode":""}},"authTokenResponse":{"name":"authTokenResponse","type":"apogee.JsonMember","updateData":{"data":{"token_type":"Bearer","scope":"wl.offline_access Files.Read.All Files.ReadWrite.All Files.Read","expires_in":3600,"ext_expires_in":3600,"access_token":"EwAgA61DBAAUzl/nWKUlBg14ZGcybuC4/OHFdfEAAaKGk/KLDBxBluMEkUTT0oyZBbW/Buq/k3d0SnT2793JXpQwNVYuVRUGHCxwS1YFM4ILpc+ShpjUCAb9ti27YksBZW59aBXtdYpw8ZcB5Ef25oOnrxX43dagF/w4nFeU3QmW4f3Sbu+t4cUD0vdaqGUNKf3n1QA2HHsGfnOHUCOAugL+rfMNS19InD43G5fCWLNgC6eM+lmGnfCDa7eHq0jmLAfUWNvyDl8AyLlZu0Mg0EBFbNCpDIc4RxiR0f1Xnn8SKtxuOQFzxL/bd4jSEjxkt0A8ZGWco+/zmso7BUFdIonwPTDb96s891YfYiUZ2lC32th6+HoLgtAtJXxktwcDZgAACFaJ4QDwNmXb8AGtcB+lA4RM3QxCt/TWSwzkhPY/jejPnSThLzTXrZxJO5DnEZs61qQ8qAh4VC/0DCR7qC3yKUJy/L7ZGp7OIEbr+tgtQflmJW3QStiVKxqUvwlnnL6/Fy8SQrKD2AKHYkB9DZ8sz8FhQb5yATNXXDD8aWBGQeKXRoq5cQb0uXBYIyAVTOzXLJeyAvYotQ2DEUfKi8UMd2sxrX3OmUUtbomTzQOf1aUNswqugq4ZPN/5SF9ZhJwxrD6fhQiOt58Y3LXLvdqnbETvzgmkyA/GxFtBawFsEXdlTCkiWsZwZrVo7Gl05X4LTgH6S3l1KEoj/IWf8y/L+JYYugEJkLQ5Id+Gux7YEQJsyqUZ2rqqJ4ARLT9pvoQBUVXf73DN7TLvK/3erWleeZnaDkjHksx1yVQvXk4cvZZpW0ExQitmriBYyOjwUR2gl58D5NlfTYTI++0+rJBv3sbuBbObH8YDIqhwt9tuBzaf1h884NwV2U/RpbLQRB5EUnsOxfMEgQnCiAx53IiK6o6hozgxHyNoHmxVNue9Rz2ysNSkbOLvXRr240EWA15GltUlIvOXCdWc6F3oCDPjTwoZPkR5nDlZVr40PcM8xtwl6bNGGjatk/SCRVlICziY7+Erl7cU/zTR2Vz/PfUglGfd/RtZbC9SQ1DVJQI=","refresh_token":"M.R3_BAY.CQWeMrtk27sRNZQANkhBfKHGMGJraHH6j0O56Fxl6T0Hem6WyAbOzHrdHBK3fVDcygTxA5x!LFXCmvjz*iGznDXpL5AXe1hWp6fpJ!ZHkawPIbTFdtJLjoax3oVS6o9UnnzcsbM!yeBOpWBNGudOHMH7QszMNzlqiYMZNPwzYSLrGb7vxrxksBdNa40mgFg2NlWXMrv2ieK8VH1yPEmINrz6EPoRv3AmxjjOVKhTOxieiK74*pjZrdazTn5d!hhUh*k6R0e2*x5wR9f!*!CgvIxWtqoPm8VD!x3Idji4ScNnmjH7keJ9TDhdt3jnsoifgN4f41I6VP1hL8I1HJaUr4phcqCoYhXti1EXLNtpDk1**1uLZ0R6DUiq!OOUdXdd!A$$"}}},"refreshTokenForm":{"name":"refreshTokenForm","type":"apogee.FunctionMember","updateData":{"argList":["admin"],"functionBody":"let onLoadToken = () => {\n    //should we verify requesting page is https/file/localhost?\n    let url = \"https://login.microsoftonline.com/common/oauth2/v2.0/token\";\n    let options = {\n        method: \"POST\",\n        header: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        body: `client_id=${oneDriveAppInfo.clientId}&redirect_uri=${oneDriveAppInfo.redirectUri}&client_secret=${oneDriveAppInfo.clientSecret}&refresh_token=${authTokenResponse.refresh_token}&scope=user.read&grant_type=refresh_token`\n    }\n    \n    let tokenPromise = apogeeutil.jsonRequest(url,options);\n    admin.getCommandMessenger().dataCommand(\"refreshTokenResponse\",tokenPromise);\n}\n\n\nreturn [\n    {\n        type: \"submit\",\n        onSubmit: onLoadToken,\n        submitLabel: \"Refresh Token\",\n    }    \n]","supplementalCode":""}},"refreshTokenResponse":{"name":"refreshTokenResponse","type":"apogee.JsonMember","updateData":{"data":{"token_type":"Bearer","scope":"User.Read Files.Read.All Files.ReadWrite.All Files.Read","expires_in":3600,"ext_expires_in":3600,"access_token":"EwBoA8l6BAAU6k7+XVQzkGyMv7VHB/h4cHbJYRAAAaXEndq+VUaKQv2eulh2TCV2sZymqynq5Ke1qWLJa8rXHoMGlRPSzvc53CcUnPp+t65UyGw9zSbQggKpdzeWKbbpahs/+jLbmcCQFOFQd4u++V9fRSPSnJkT+3xAmDdvAJGLssqjj1utQNHIsIEgyIv8RE1ddhJzmJ5W1LXfBAyULxOuRpJI1q3+jITG1JIJ9D4wu6PymECGcDjKmPb3pIG37ffNUyTQs0kDd+6ptygmwQUYNUc119NbydQGPtubabhdoc86tOTsWDFKnGtnPTuNJ9kHT6B3A3dddWOqUmjgDobocNExZB/fQK6qPNlIKq0H3/3tvUEgJE26v1pSKRcDZgAACFBGR+Nkwti0OAI+7W5qCmdIXEMk2yeohRujRanTY8yPYmCyV5yKQtggeX//zveIC/CIXxrTRv1CMlBCMcJeRvhS0mW/8jhput5+egnZI+omKq+S2UyWk6IOPOEv0xaOUAhkm7bmb4i+6a44303VtKKL0S9gYHK9JZN/lDjjVxJ05ibNHwDcOm89ClfUGCAhvOrI2QknxEEIKNCPJknlk9pPyzZaMccQc6qGj5uOUcT/QrWQalMelEZlk9LskSDBNbhMJCsB7tBtQVfLbhpLpCPY8rg7peR0SinJXpjHEGVN59bt8pBrNUvJhVn4rKmutluTxjkqMiDVa7lvYmZDDFt91ZPrjR8+yU57/dmGS3FtbCdiaIBkof8h1pke9bSyl4X/N1/vXGaiVyE1cL0h25eEimq22NNb5YUtM/XcketpYbwvePhw+JohRNZKGtCGP2EL5dwbWVb2OewQqTfkvPMeLF2Um91Qb4/MehwosDoEnjs3IVkjyNksLT2KHR52VHZ+A0AI6cGUYP6iJjtYF2DBbuKDWRlGrRPfmv6i/7OjtMfO7Qzjua3/Z0oYeY4Nr+lhh2b3OUJYehyrPpza5aJwSqK4iHe4yXS9BDHQvalen0KNLb2iMKz71YqT6o0YqNtlGst/DI4CcW4GgaFE7tODTv6G9PjGhx8IPCL/sAN6kzO8jFonRlfJ2K+xa2//bjqb8Yt9+oqEUUvnC0Ll+zFlha0HGqZRjD6ZBPNF+3yZXQdM2iODukP1cOixH8auKz1GfAI="}}},"token":{"name":"token","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return refreshTokenResponse.access_token\n//return authTokenResponse.access_token","supplementalCode":""}}}},"utils":{"name":"utils","type":"apogee.Folder","children":{"openPopup":{"name":"openPopup","type":"apogee.FunctionMember","updateData":{"argList":["url"],"functionBody":"var width = 525,\r\n            height = 525,\r\n            screenX = window.screenX,\r\n            screenY = window.screenY,\r\n            outerWidth = window.outerWidth,\r\n            outerHeight = window.outerHeight;\r\n\r\n    var left = screenX + Math.max(outerWidth - width, 0) / 2;\r\n    var top = screenY + Math.max(outerHeight - height, 0) / 2;\r\n\r\n    var features = [\r\n                            \"width=\" + width,\r\n                            \"height=\" + height,\r\n                            \"top=\" + top,\r\n                            \"left=\" + left,\r\n                            \"status=no\",\r\n                            \"resizable=yes\",\r\n                            \"toolbar=no\",\r\n                            \"menubar=no\",\r\n                            \"scrollbars=yes\"];\r\n    var popup = window.open(url, \"oauth\", features.join(\",\"));\r\n    if (!popup) {\r\n        alert(\"failed to pop up auth window\");\r\n    }\r\n\r\n    popup.focus();","supplementalCode":""}}}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"One Drive Auth - Code Flow"}]},{"type":"paragraph","content":[{"type":"text","text":"I have this making requests, but I don't quite understand what it is doing."}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"I can only do one token request for a single code request, it seems."}]},{"type":"listItem","content":[{"type":"text","text":"If I use the scope \"wl.offline_access\" then I can request a refresh token. But when I do this, I can't make a request of the initial token, only the refresh token"}]},{"type":"listItem","content":[{"type":"text","text":"I also don't quite understand the scopes. The documentation didn't include this as a needed parameter in requesting a token, but I errored without it for wl_offline."}]}]},{"type":"paragraph","content":[{"type":"text","text":"I think the token flow seems to be ok."}]},{"type":"heading2","content":[{"type":"text","text":"Authentication"}]},{"type":"paragraph","content":[{"type":"text","text":"Here is some basic app info needed. (Note the scopes can be changed, but I need offline access for refresh tokens.)"}]},{"type":"apogeeComponent","attrs":{"name":"oneDriveAppInfo","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here I get the code."}]},{"type":"apogeeComponent","attrs":{"name":"loginForm","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"This is data loaded from my global callback."}]},{"type":"apogeeComponent","attrs":{"name":"oneDriveCallbackData","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is my auth code."}]},{"type":"apogeeComponent","attrs":{"name":"authCodeData","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is a form to get an auth token from the auth code."}]},{"type":"apogeeComponent","attrs":{"name":"authTokenForm","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"authTokenResponse","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"This form gets a refresh token."}]},{"type":"apogeeComponent","attrs":{"name":"refreshTokenForm","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"refreshTokenResponse","id":0,"state":""}},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"This is my token. I can not get the orignial auth token to work if I amm offline. But refresh auth token works."}]},{"type":"apogeeComponent","attrs":{"name":"token","id":0,"state":""}},{"type":"paragraph"},{"type":"heading2","content":[{"type":"text","text":"One Drive Requests"}]},{"type":"paragraph","content":[{"type":"text","text":"Here I make a simple file browser."}]},{"type":"apogeeComponent","attrs":{"name":"baseUrl","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"driveBaseUrl","id":0,"state":""}},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"Here we give the folder path. The root folder has path \"\" (not \"/\"!)"}]},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"folderPath","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"We give the content for this folder"}]},{"type":"apogeeComponent","attrs":{"name":"driveResponse","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here we parse the child info, to show in our \"open form\""}]},{"type":"apogeeComponent","attrs":{"name":"childEntries","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"parentInfo","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"This form opens a child (uh, or parent). If it is a folder it loads the folder here. If it is a file it loads the file below."}]},{"type":"apogeeComponent","attrs":{"name":"openForm","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Child File"}]},{"type":"paragraph","content":[{"type":"text","text":"Here I display the content of a child file."}]},{"type":"apogeeComponent","attrs":{"name":"fileName","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"fileContent","id":0,"state":""}},{"type":"paragraph"},{"type":"paragraph"},{"type":"paragraph"},{"type":"paragraph"}]}},"children":{"oneDriveAppInfo":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"loginForm":{"type":"apogeeapp.ActionFormCell","viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false,"height":7000}}}}},"baseUrl":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"driveResponse":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":false,"height":280},"Formula":{"isViewActive":false,"height":7000},"Private":{"isViewActive":false}}}}},"folderPath":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"driveBaseUrl":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"parentInfo":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":false,"height":280},"Formula":{"isViewActive":false,"height":7000},"Private":{"isViewActive":false}}}}},"childEntries":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"height":280,"isViewActive":false},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"fileName":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"fileContent":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"openForm":{"type":"apogeeapp.ActionFormCell","viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Code":{"isViewActive":false,"height":7000},"Private":{"isViewActive":false}}}}},"oneDriveCallbackData":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"authCodeData":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"authTokenForm":{"type":"apogeeapp.ActionFormCell","viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"authTokenResponse":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"refreshTokenForm":{"type":"apogeeapp.ActionFormCell","viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"refreshTokenResponse":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"token":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true,"tabShowing":true}},"utils":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Utils"}]},{"type":"heading2","content":[{"type":"text","text":"Open Popup"}]},{"type":"paragraph","content":[{"type":"text","text":"This function opens a child window at the given URL. This is intended for OAuth sign in."}]},{"type":"apogeeComponent","attrs":{"name":"openPopup","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"External Receiver"}]}]}},"children":{"openPopup":{"type":"apogeeapp.FunctionCell","viewState":{"childDisplayState":{"views":{"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}